<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-COLUMN ê³µì •ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #2c4a7c, #4a6fa5);
            color: white;
            padding: 20px 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .header-info {
            text-align: right;
            font-size: 14px;
        }

        /* Company Selector */
        .company-selector {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .company-selector h3 {
            margin-bottom: 15px;
            color: #2c4a7c;
        }

        .company-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .company-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 200px;
        }

        .company-btn.yuseok {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .company-btn.jusin {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .company-btn.jinhung {
            background: linear-gradient(135deg, #27ae60, #1e8449);
            color: white;
        }

        /* Process Buttons */
        .process-btn.p1 {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        .process-btn.p2 {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
        }
        .process-btn.p3 {
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
        }
        .process-btn.p4 {
            background: linear-gradient(135deg, #00bcd4, #0097a7);
            color: white;
        }
        .process-btn.p5 {
            background: linear-gradient(135deg, #9c27b0, #7b1fa2);
            color: white;
        }
        .process-btn.p6 {
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .process-btn.active {
            box-shadow: 0 0 0 4px #ffd700;
            transform: scale(1.05);
        }

        .company-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .company-btn.active {
            box-shadow: 0 0 0 4px rgba(255,255,255,0.5), 0 4px 15px rgba(0,0,0,0.3);
            transform: scale(1.02);
        }

        .company-btn small {
            display: block;
            font-weight: 400;
            margin-top: 5px;
            opacity: 0.9;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            padding: 12px 25px;
            background: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: #666;
        }

        .tab-btn.active {
            background: #2c4a7c;
            color: white;
        }

        .tab-btn:hover:not(.active) {
            background: #f0f0f0;
        }

        /* Content Panels */
        .panel {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .panel.active {
            display: block;
        }

        /* Input Panel */
        .input-section {
            margin-bottom: 20px;
        }

        .input-section h3 {
            margin-bottom: 15px;
            color: #2c4a7c;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .date-selector {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .date-selector label {
            font-weight: 600;
            color: #555;
        }

        .date-selector input[type="date"] {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }

        /* Column Grid */
        .column-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .column-item {
            position: relative;
            aspect-ratio: 1;
            border: 2px solid #ddd;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            background: #f8f9fa;
            font-size: 12px;
        }

        .column-item:hover {
            border-color: #2c4a7c;
            transform: scale(1.05);
            z-index: 10;
        }

        .column-item .col-num {
            font-weight: 700;
            font-size: 14px;
            color: #333;
        }

        .column-item .col-status {
            font-size: 10px;
            color: #666;
            margin-top: 2px;
        }

        /* Status Colors */
        .column-item.status-0 { background: #f8f9fa; border-color: #ddd; }
        .column-item.status-1 { background: #ffebee; border-color: #e74c3c; }
        .column-item.status-2 { background: #fff3e0; border-color: #ff9800; }
        .column-item.status-3 { background: #e3f2fd; border-color: #2196f3; }
        .column-item.status-4 { background: #e0f7fa; border-color: #00bcd4; }
        .column-item.status-5 { background: #f3e5f5; border-color: #9c27b0; }
        .column-item.status-6 { background: #4caf50; border-color: #2e7d32; color: white; }
        .column-item.status-6 .col-num, .column-item.status-6 .col-status { color: white; }

        /* Process Legend */
        .process-legend {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        /* Gantt Chart */
        .gantt-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        .gantt-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            min-width: 2000px;
        }

        .gantt-table th, .gantt-table td {
            border: 1px solid #ddd;
            padding: 4px;
            text-align: center;
            min-width: 30px;
        }

        .gantt-table th {
            background: #2c4a7c;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .gantt-table th.col-header {
            min-width: 80px;
            background: #1a3a5c;
        }

        .gantt-table .date-header {
            font-size: 10px;
        }

        .gantt-table .weekend {
            background: #fff3e0 !important;
        }

        .gantt-table td.col-name {
            background: #f5f5f5;
            font-weight: 600;
            text-align: left;
            padding-left: 10px;
            position: sticky;
            left: 0;
            z-index: 5;
        }

        .gantt-cell {
            width: 100%;
            height: 20px;
            cursor: pointer;
        }

        .gantt-cell.p1 { background: #e74c3c; }
        .gantt-cell.p2 { background: #ff9800; }
        .gantt-cell.p3 { background: #2196f3; }
        .gantt-cell.p4 { background: #00bcd4; }
        .gantt-cell.p5 { background: #9c27b0; }
        .gantt-cell.p6 { background: #4caf50; }

        /* íœ´ë¬´ì¼ ìŠ¤íƒ€ì¼ */
        .gantt-table .holiday {
            background: #ffcdd2 !important;
            position: relative;
        }
        .gantt-table .holiday-header {
            background: #e53935 !important;
            color: white !important;
        }
        .holiday-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 8px;
            color: #c62828;
            white-space: nowrap;
            font-weight: bold;
        }

        /* Progress Summary */
        .progress-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 1200px) {
            .progress-summary {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .progress-summary {
                grid-template-columns: 1fr;
            }
        }

        .progress-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .progress-card h4 {
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-card .company-badge {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 11px;
            color: white;
        }

        .progress-card .company-badge.yuseok { background: #e74c3c; }
        .progress-card .company-badge.jusin { background: #3498db; }
        .progress-card .company-badge.jinhung { background: #27ae60; }

        .progress-bar-container {
            margin-bottom: 10px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 13px;
        }

        .progress-bar {
            height: 24px;
            background: #e0e0e0;
            border-radius: 12px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            border-radius: 12px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 11px;
        }

        .progress-bar-fill.p1 { background: linear-gradient(90deg, #e74c3c, #c0392b); }
        .progress-bar-fill.p2 { background: linear-gradient(90deg, #ff9800, #f57c00); }
        .progress-bar-fill.p3 { background: linear-gradient(90deg, #2196f3, #1976d2); }
        .progress-bar-fill.p4 { background: linear-gradient(90deg, #00bcd4, #0097a7); }
        .progress-bar-fill.p5 { background: linear-gradient(90deg, #9c27b0, #7b1fa2); }
        .progress-bar-fill.p6 { background: linear-gradient(90deg, #4caf50, #388e3c); }

        /* Chart Container */
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .chart-container h3 {
            margin-bottom: 20px;
            color: #2c4a7c;
        }

        #progressChart {
            max-height: 400px;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .action-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-btn.primary {
            background: #2c4a7c;
            color: white;
        }

        .action-btn.secondary {
            background: #6c757d;
            color: white;
        }

        .action-btn.danger {
            background: #dc3545;
            color: white;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-content h3 {
            margin-bottom: 20px;
            color: #2c4a7c;
        }

        .modal-content .form-group {
            margin-bottom: 15px;
        }

        .modal-content label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }

        .modal-content select, .modal-content input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .column-grid {
                grid-template-columns: repeat(5, 1fr);
            }
            
            .company-buttons {
                flex-direction: column;
            }
            
            .company-btn {
                min-width: 100%;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div>
                <h1>ğŸ—ï¸ K-COLUMN ê³µì •ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
                <p style="margin-top:5px;opacity:0.9;">K-COLUMN 50EA ì œì‘ ë° ì„¤ì¹˜ ê³µì •</p>
            </div>
            <div class="header-info">
                <div>ê³µì‚¬ê¸°ê°„: 2025.12.26 ~ 2026.02.28</div>
                <div style="margin-top:5px;">ì´ ê¸°ë‘¥ìˆ˜: <strong>50ê°œ</strong></div>
            </div>
        </div>

        <!-- Company Selector -->
        <div class="company-selector">
            <h3>ğŸ“Œ ê³µì •ë³„ ì…ë ¥ ì„ íƒ</h3>
            <div class="company-buttons" style="display:grid;grid-template-columns:repeat(6,1fr);gap:8px;">
                <button class="company-btn process-btn p1" data-process="1" onclick="selectProcess(1)">
                    1. ì£¼ê¸°ë‘¥ì»¤íŒ…
                    <small>ìœ ì„ì² ê°•</small>
                </button>
                <button class="company-btn process-btn p2" data-process="2" onclick="selectProcess(2)">
                    2. ì†Œë¶€ì¬ê°€ê³µ
                    <small>ìœ ì„ì² ê°•</small>
                </button>
                <button class="company-btn process-btn p3" data-process="3" onclick="selectProcess(3)">
                    3. ì£¼ê¸°ë‘¥ì¡°ë¦½
                    <small>ì£¼ì‹ ì‚°ì—…</small>
                </button>
                <button class="company-btn process-btn p4" data-process="4" onclick="selectProcess(4)">
                    4. ì†Œë¶€ì¬ì¡°ë¦½
                    <small>ì£¼ì‹ ì‚°ì—…</small>
                </button>
                <button class="company-btn process-btn p5" data-process="5" onclick="selectProcess(5)">
                    5. í˜„ì¥ë°°ì†¡
                    <small>ì£¼ì‹ ì‚°ì—…</small>
                </button>
                <button class="company-btn process-btn p6" data-process="6" onclick="selectProcess(6)">
                    6. í˜„ì¥ì„¤ì¹˜
                    <small>ì§„í¥ê¸°ì—…</small>
                </button>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-btn active" onclick="showPanel('overview')">ğŸ“Š ì „ì²´ í˜„í™©</button>
            <button class="tab-btn" onclick="showPanel('input')">âœï¸ ì¼ì¼ ì…ë ¥</button>
            <button class="tab-btn" onclick="showPanel('gantt')">ğŸ“… ê³µì •í‘œ (Gantt)</button>
            <button class="tab-btn" onclick="showPanel('chart')">ğŸ“ˆ ì§„í–‰ë¥  ì°¨íŠ¸</button>
        </div>

        <!-- Overview Panel -->
        <div class="panel active" id="panel-overview">
            <h3 style="margin-bottom:20px;color:#2c4a7c;">ğŸ“Š ì „ì²´ ê³µì • í˜„í™©</h3>
            
            <!-- Progress Summary -->
            <div class="progress-summary">
                <div class="progress-card">
                    <h4>
                        <span>1. ì£¼ê¸°ë‘¥ì»¤íŒ…</span>
                        <span class="company-badge yuseok">ìœ ì„ì² ê°•</span>
                    </h4>
                    <div class="progress-bar-container">
                        <div class="progress-label">
                            <span>ì™„ë£Œ</span>
                            <span id="progress-p1-text">0 / 50</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill p1" id="progress-p1" style="width:0%">0%</div>
                        </div>
                    </div>
                </div>

                <div class="progress-card">
                    <h4>
                        <span>2. ì†Œë¶€ì¬ê°€ê³µ</span>
                        <span class="company-badge yuseok">ìœ ì„ì² ê°•</span>
                    </h4>
                    <div class="progress-bar-container">
                        <div class="progress-label">
                            <span>ì™„ë£Œ</span>
                            <span id="progress-p2-text">0 / 50</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill p2" id="progress-p2" style="width:0%">0%</div>
                        </div>
                    </div>
                </div>

                <div class="progress-card">
                    <h4>
                        <span>3. ì£¼ê¸°ë‘¥ì¡°ë¦½</span>
                        <span class="company-badge jusin">ì£¼ì‹ ì‚°ì—…</span>
                    </h4>
                    <div class="progress-bar-container">
                        <div class="progress-label">
                            <span>ì™„ë£Œ</span>
                            <span id="progress-p3-text">0 / 50</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill p3" id="progress-p3" style="width:0%">0%</div>
                        </div>
                    </div>
                </div>

                <div class="progress-card">
                    <h4>
                        <span>4. ì†Œë¶€ì¬ì¡°ë¦½</span>
                        <span class="company-badge jusin">ì£¼ì‹ ì‚°ì—…</span>
                    </h4>
                    <div class="progress-bar-container">
                        <div class="progress-label">
                            <span>ì™„ë£Œ</span>
                            <span id="progress-p4-text">0 / 50</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill p4" id="progress-p4" style="width:0%">0%</div>
                        </div>
                    </div>
                </div>

                <div class="progress-card">
                    <h4>
                        <span>5. í˜„ì¥ë°°ì†¡</span>
                        <span class="company-badge jusin">ì£¼ì‹ ì‚°ì—…</span>
                    </h4>
                    <div class="progress-bar-container">
                        <div class="progress-label">
                            <span>ì™„ë£Œ</span>
                            <span id="progress-p5-text">0 / 50</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill p5" id="progress-p5" style="width:0%">0%</div>
                        </div>
                    </div>
                </div>

                <div class="progress-card">
                    <h4>
                        <span>6. í˜„ì¥ì„¤ì¹˜</span>
                        <span class="company-badge jinhung">ì§„í¥ê¸°ì—…</span>
                    </h4>
                    <div class="progress-bar-container">
                        <div class="progress-label">
                            <span>ì™„ë£Œ</span>
                            <span id="progress-p6-text">0 / 50</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill p6" id="progress-p6" style="width:0%">0%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Column Status Grid -->
            <h3 style="margin:20px 0 15px;color:#2c4a7c;">ğŸ”© ê¸°ë‘¥ë³„ í˜„ì¬ ê³µì • ìƒíƒœ</h3>
            <div class="process-legend">
                <div class="legend-item"><div class="legend-color" style="background:#f8f9fa;"></div><span>ë¯¸ì°©ìˆ˜</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#ffebee;"></div><span>1.ì£¼ê¸°ë‘¥ì»¤íŒ…</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#fff3e0;"></div><span>2.ì†Œë¶€ì¬ê°€ê³µ</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#e3f2fd;"></div><span>3.ì£¼ê¸°ë‘¥ì¡°ë¦½</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#e0f7fa;"></div><span>4.ì†Œë¶€ì¬ì¡°ë¦½</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#f3e5f5;"></div><span>5.í˜„ì¥ë°°ì†¡</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#4caf50;"></div><span>6.ì„¤ì¹˜ì™„ë£Œ</span></div>
            </div>
            <div class="column-grid" id="column-grid-overview">
                <!-- Generated by JS -->
            </div>
        </div>

        <!-- Input Panel -->
        <div class="panel" id="panel-input">
            <div class="input-section">
                <h3>âœï¸ ì¼ì¼ ê³µì • ì…ë ¥ <span id="selected-company-name" style="color:#666;font-weight:400;font-size:14px;"></span></h3>
                
                <div class="date-selector">
                    <label>ğŸ“… ì‘ì—…ì¼ì:</label>
                    <input type="date" id="work-date" onchange="loadDayData()">
                    <button class="action-btn primary" onclick="setToday()">ì˜¤ëŠ˜</button>
                </div>

                <div class="process-legend">
                    <div class="legend-item"><div class="legend-color" style="background:#f8f9fa;"></div><span>ë¯¸ì°©ìˆ˜</span></div>
                    <div class="legend-item"><div class="legend-color" style="background:#ffebee;"></div><span>1.ì£¼ê¸°ë‘¥ì»¤íŒ…</span></div>
                    <div class="legend-item"><div class="legend-color" style="background:#fff3e0;"></div><span>2.ì†Œë¶€ì¬ê°€ê³µ</span></div>
                    <div class="legend-item"><div class="legend-color" style="background:#e3f2fd;"></div><span>3.ì£¼ê¸°ë‘¥ì¡°ë¦½</span></div>
                    <div class="legend-item"><div class="legend-color" style="background:#e0f7fa;"></div><span>4.ì†Œë¶€ì¬ì¡°ë¦½</span></div>
                    <div class="legend-item"><div class="legend-color" style="background:#f3e5f5;"></div><span>5.í˜„ì¥ë°°ì†¡</span></div>
                    <div class="legend-item"><div class="legend-color" style="background:#4caf50;"></div><span>6.ì„¤ì¹˜ì™„ë£Œ</span></div>
                </div>

                <div id="process-guide" style="margin-bottom:15px;padding:15px;background:#fff8e1;border-radius:8px;border:1px solid #ffc107;">
                    <div style="margin-bottom:10px;">
                        <strong style="font-size:14px;color:#795548;">ğŸ’¡ ì…ë ¥ ì•ˆë‚´</strong>
                    </div>
                    <div style="font-size:13px;color:#795548;">
                        <div style="margin:3px 0;">â‘  ìœ„ì—ì„œ <strong>ì…ë ¥í•  ê³µì • ë²„íŠ¼</strong>ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</div>
                        <div style="margin:3px 0;">â‘¡ ìƒì„¸ ì…ë ¥ ë°©ë²•ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>
                    </div>
                </div>
                <div id="guide-stats" style="margin-bottom:10px;padding:10px;background:#e8f5e9;border-radius:6px;font-size:12px;color:#2e7d32;display:none;"></div>

                <div class="column-grid" id="column-grid-input">
                    <!-- Generated by JS -->
                </div>

                <div class="action-buttons">
                    <button class="action-btn primary" onclick="saveData()">ğŸ’¾ ì €ì¥</button>
                    <button class="action-btn secondary" onclick="exportData()">ğŸ“¥ ë‚´ë³´ë‚´ê¸°</button>
                    <label class="action-btn secondary" style="cursor:pointer;">
                        ğŸ“¤ ê°€ì ¸ì˜¤ê¸°
                        <input type="file" accept=".json" onchange="importData(event)" style="display:none;">
                    </label>
                </div>
                <p style="margin-top:15px;padding:15px;background:#e3f2fd;border-radius:8px;font-size:13px;color:#1565c0;">
                    ğŸ’¡ <strong>ì‹¤ì‹œê°„ ê³µìœ  ì„¤ì •:</strong> 3ê°œ ì—…ì²´ê°€ ê°ì ì¥ì†Œì—ì„œ ì…ë ¥í•˜ë ¤ë©´ Firebase ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.<br>
                    í˜„ì¬ ëª¨ë“œ: <span id="current-mode" style="font-weight:bold;">í™•ì¸ ì¤‘...</span>
                </p>
            </div>
        </div>

        <!-- Gantt Panel -->
        <div class="panel" id="panel-gantt">
            <h3 style="margin-bottom:20px;color:#2c4a7c;">ğŸ“… ì „ì²´ ê³µì •í‘œ (Gantt Chart)</h3>
            
            <div class="process-legend">
                <div class="legend-item"><div class="legend-color" style="background:#e74c3c;"></div><span>1.ì£¼ê¸°ë‘¥ì»¤íŒ…</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#ff9800;"></div><span>2.ì†Œë¶€ì¬ê°€ê³µ</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#2196f3;"></div><span>3.ì£¼ê¸°ë‘¥ì¡°ë¦½</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#00bcd4;"></div><span>4.ì†Œë¶€ì¬ì¡°ë¦½</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#9c27b0;"></div><span>5.í˜„ì¥ë°°ì†¡</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#4caf50;"></div><span>6.í˜„ì¥ì„¤ì¹˜</span></div>
            </div>

            <div class="gantt-container">
                <table class="gantt-table" id="gantt-table">
                    <!-- Generated by JS -->
                </table>
            </div>
        </div>

        <!-- Chart Panel -->
        <div class="panel" id="panel-chart">
            <div class="chart-container">
                <h3>ğŸ“ˆ ì¼ë³„ ëˆ„ì  ì§„í–‰ë¥ </h3>
                <canvas id="progressChart"></canvas>
            </div>

            <div class="chart-container">
                <h3>ğŸ“Š ì—…ì²´ë³„ ê³µì • í˜„í™©</h3>
                <canvas id="companyChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Column Detail Modal -->
    <div class="modal" id="column-modal">
        <div class="modal-content">
            <h3>ğŸ”© ê¸°ë‘¥ <span id="modal-column-num"></span> ê³µì • ì…ë ¥</h3>
            <div class="form-group">
                <label>í˜„ì¬ ê³µì • ìƒíƒœ:</label>
                <select id="modal-process-select">
                    <option value="0">0. ë¯¸ì°©ìˆ˜</option>
                    <option value="1">1. ì£¼ê¸°ë‘¥ì»¤íŒ… ì™„ë£Œ</option>
                    <option value="2">2. ê¸°ë‘¥ì†Œë¶€ì¬ê°€ê³µ ì™„ë£Œ</option>
                    <option value="3">3. ì£¼ê¸°ë‘¥ì¡°ë¦½ ì™„ë£Œ</option>
                    <option value="4">4. í˜„ì¥ë°°ì†¡ ì™„ë£Œ</option>
                    <option value="5">5. í˜„ì¥ì„¤ì¹˜ ì™„ë£Œ</option>
                </select>
            </div>
            <div class="form-group">
                <label>ë¹„ê³ :</label>
                <input type="text" id="modal-note" placeholder="íŠ¹ì´ì‚¬í•­ ì…ë ¥">
            </div>
            <div class="modal-buttons">
                <button class="action-btn primary" onclick="saveColumnStatus()">ì €ì¥</button>
                <button class="action-btn secondary" onclick="closeModal()">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        // âš ï¸ ì‹¤ì œ ì‚¬ìš© ì‹œ ì•„ë˜ ì„¤ì •ì„ Firebase Consoleì—ì„œ ìƒì„±í•œ í”„ë¡œì íŠ¸ ì„¤ì •ìœ¼ë¡œ êµì²´í•˜ì„¸ìš”
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT-default-rtdb.firebaseio.com",
            projectId: "YOUR_PROJECT",
            storageBucket: "YOUR_PROJECT.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Firebase ì´ˆê¸°í™”
        let db = null;
        let isFirebaseEnabled = false;
        
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.database();
            isFirebaseEnabled = firebaseConfig.apiKey !== "YOUR_API_KEY";
        } catch (e) {
            console.log('Firebase ì´ˆê¸°í™” ì‹¤íŒ¨, localStorage ëª¨ë“œë¡œ ì „í™˜:', e);
        }

        // Constants
        const TOTAL_COLUMNS = 50;
        const START_DATE = new Date('2025-12-26');
        const END_DATE = new Date('2026-02-28');
        
        // íœ´ë¬´ì¼ ì •ì˜ (ì„¤ë‚  ì—°íœ´)
        const HOLIDAYS = {
            '2026-02-16': 'ì„¤ë‚ íœ´ë¬´',
            '2026-02-17': 'ì„¤ë‚ íœ´ë¬´',
            '2026-02-18': 'ì„¤ë‚ íœ´ë¬´'
        };
        
        const PROCESSES = [
            { id: 1, name: 'ì£¼ê¸°ë‘¥ì»¤íŒ…', company: 'yuseok' },
            { id: 2, name: 'ê¸°ë‘¥ì†Œë¶€ì¬ê°€ê³µ', company: 'yuseok' },
            { id: 3, name: 'ì£¼ê¸°ë‘¥ì¡°ë¦½', company: 'jusin' },
            { id: 4, name: 'ì†Œë¶€ì¬ì¡°ë¦½', company: 'jusin' },
            { id: 5, name: 'í˜„ì¥ë°°ì†¡', company: 'jusin' },
            { id: 6, name: 'í˜„ì¥ì„¤ì¹˜', company: 'jinhung' }
        ];

        // State
        let currentCompany = null;
        let currentProcess = null; // í˜„ì¬ ì„ íƒëœ ê³µì • (1-5)
        let selectedColumn = null;
        let columnData = {}; // { columnId: { status: 0-5, date: '2025-12-26', notes: '' } }
        let dailyData = {}; // { '2025-12-26': { 1: [columnIds completed p1], 2: [...], ... } }
        let progressChart = null;
        let companyChart = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            if (isFirebaseEnabled) {
                // Firebase ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
                setupFirebaseListeners();
                showConnectionStatus('ğŸŸ¢ ì‹¤ì‹œê°„ ì—°ê²°ë¨ (Firebase)');
            } else {
                // localStorage ëª¨ë“œ
                loadFromLocalStorage();
                showConnectionStatus('ğŸŸ¡ ë¡œì»¬ ì €ì¥ ëª¨ë“œ (Firebase ì„¤ì • í•„ìš”)');
            }
            setToday();
            renderColumnGrid('column-grid-overview');
            renderColumnGrid('column-grid-input');
            updateProgressBars();
        });

        // ì—°ê²° ìƒíƒœ í‘œì‹œ
        function showConnectionStatus(message) {
            // ìƒíƒœ ì•Œë¦¼
            const statusDiv = document.createElement('div');
            statusDiv.style.cssText = 'position:fixed;bottom:20px;right:20px;background:#333;color:white;padding:10px 20px;border-radius:8px;font-size:12px;z-index:9999;';
            statusDiv.textContent = message;
            document.body.appendChild(statusDiv);
            setTimeout(() => statusDiv.remove(), 5000);
            
            // ëª¨ë“œ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            const modeEl = document.getElementById('current-mode');
            if (modeEl) {
                if (isFirebaseEnabled) {
                    modeEl.textContent = 'ğŸŸ¢ ì‹¤ì‹œê°„ ê³µìœ  ëª¨ë“œ (Firebase ì—°ê²°ë¨)';
                    modeEl.style.color = '#2e7d32';
                } else {
                    modeEl.textContent = 'ğŸŸ¡ ë¡œì»¬ ì €ì¥ ëª¨ë“œ (ê°™ì€ ë¸Œë¼ìš°ì €ì—ì„œë§Œ ê³µìœ )';
                    modeEl.style.color = '#f57c00';
                }
            }
        }

        // Firebase ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ
        function setupFirebaseListeners() {
            // columnData ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ
            db.ref('kcolumn/columnData').on('value', (snapshot) => {
                columnData = snapshot.val() || {};
                renderColumnGrid('column-grid-overview');
                renderColumnGrid('column-grid-input');
                updateProgressBars();
            });

            // dailyData ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ
            db.ref('kcolumn/dailyData').on('value', (snapshot) => {
                dailyData = snapshot.val() || {};
            });
        }

        // Process Selection (ê³µì •ë³„ ì„ íƒ)
        function selectProcess(processId) {
            currentProcess = processId;
            
            // í•´ë‹¹ ê³µì •ì˜ ë‹´ë‹¹ ì—…ì²´ ì„¤ì •
            const process = PROCESSES.find(p => p.id === processId);
            currentCompany = process?.company;
            
            // ë²„íŠ¼ í™œì„±í™” í‘œì‹œ
            document.querySelectorAll('.process-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.process-btn.p${processId}`).classList.add('active');
            
            const processNames = {
                1: '1. ì£¼ê¸°ë‘¥ì»¤íŒ… (ìœ ì„ì² ê°•)',
                2: '2. ê¸°ë‘¥ì†Œë¶€ì¬ê°€ê³µ (ìœ ì„ì² ê°•)',
                3: '3. ì£¼ê¸°ë‘¥ì¡°ë¦½ (ì£¼ì‹ ì‚°ì—…)',
                4: '4. ì†Œë¶€ì¬ì¡°ë¦½ (ì£¼ì‹ ì‚°ì—…)',
                5: '5. í˜„ì¥ë°°ì†¡ (ì£¼ì‹ ì‚°ì—…)',
                6: '6. í˜„ì¥ì„¤ì¹˜ (ì§„í¥ê¸°ì—…)'
            };
            document.getElementById('selected-company-name').textContent = '- ' + processNames[processId];
            
            // ê³µì •ë³„ ì…ë ¥ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
            showProcessGuide(processId);
            
            renderColumnGrid('column-grid-input');
        }
        
        // ê³µì •ë³„ ì…ë ¥ ì•ˆë‚´ ë©”ì‹œì§€
        function showProcessGuide(processId) {
            const guideMessages = {
                1: {
                    title: 'ğŸ”´ ì£¼ê¸°ë‘¥ì»¤íŒ… ì…ë ¥ ì•ˆë‚´',
                    company: 'ìœ ì„ì² ê°•',
                    steps: [
                        'â‘  ì‘ì—…ì¼ìë¥¼ í™•ì¸/ì„ íƒí•©ë‹ˆë‹¤',
                        'â‘¡ ê¸ˆìƒ‰ í…Œë‘ë¦¬ë¡œ ê°•ì¡°ëœ ê¸°ë‘¥(ë¯¸ì°©ìˆ˜ ìƒíƒœ)ì„ í´ë¦­í•©ë‹ˆë‹¤',
                        'â‘¢ ì»¤íŒ… ì™„ë£Œëœ ê¸°ë‘¥ì„ í™•ì¸ í›„ ì €ì¥í•©ë‹ˆë‹¤'
                    ],
                    note: 'â€» ë¯¸ì°©ìˆ˜(0ë‹¨ê³„) ìƒíƒœì˜ ê¸°ë‘¥ë§Œ ì»¤íŒ… ì™„ë£Œ ì²˜ë¦¬ ê°€ëŠ¥'
                },
                2: {
                    title: 'ğŸŸ  ê¸°ë‘¥ì†Œë¶€ì¬ê°€ê³µ ì…ë ¥ ì•ˆë‚´',
                    company: 'ìœ ì„ì² ê°•',
                    steps: [
                        'â‘  ì‘ì—…ì¼ìë¥¼ í™•ì¸/ì„ íƒí•©ë‹ˆë‹¤',
                        'â‘¡ ê¸ˆìƒ‰ í…Œë‘ë¦¬ë¡œ ê°•ì¡°ëœ ê¸°ë‘¥(ì»¤íŒ…ì™„ë£Œ ìƒíƒœ)ì„ í´ë¦­í•©ë‹ˆë‹¤',
                        'â‘¢ ì†Œë¶€ì¬ê°€ê³µ ì™„ë£Œëœ ê¸°ë‘¥ì„ í™•ì¸ í›„ ì €ì¥í•©ë‹ˆë‹¤'
                    ],
                    note: 'â€» ì£¼ê¸°ë‘¥ì»¤íŒ…(1ë‹¨ê³„)ì´ ì™„ë£Œëœ ê¸°ë‘¥ë§Œ ì†Œë¶€ì¬ê°€ê³µ ì²˜ë¦¬ ê°€ëŠ¥'
                },
                3: {
                    title: 'ğŸ”µ ì£¼ê¸°ë‘¥ì¡°ë¦½ ì…ë ¥ ì•ˆë‚´',
                    company: 'ì£¼ì‹ ì‚°ì—…',
                    steps: [
                        'â‘  ì‘ì—…ì¼ìë¥¼ í™•ì¸/ì„ íƒí•©ë‹ˆë‹¤',
                        'â‘¡ ê¸ˆìƒ‰ í…Œë‘ë¦¬ë¡œ ê°•ì¡°ëœ ê¸°ë‘¥(ì†Œë¶€ì¬ê°€ê³µì™„ë£Œ ìƒíƒœ)ì„ í´ë¦­í•©ë‹ˆë‹¤',
                        'â‘¢ ì£¼ê¸°ë‘¥ì¡°ë¦½ ì™„ë£Œëœ ê¸°ë‘¥ì„ í™•ì¸ í›„ ì €ì¥í•©ë‹ˆë‹¤'
                    ],
                    note: 'â€» ê¸°ë‘¥ì†Œë¶€ì¬ê°€ê³µ(2ë‹¨ê³„)ì´ ì™„ë£Œëœ ê¸°ë‘¥ë§Œ ì£¼ê¸°ë‘¥ì¡°ë¦½ ì²˜ë¦¬ ê°€ëŠ¥'
                },
                4: {
                    title: 'ğŸ”· ì†Œë¶€ì¬ì¡°ë¦½ ì…ë ¥ ì•ˆë‚´',
                    company: 'ì£¼ì‹ ì‚°ì—…',
                    steps: [
                        'â‘  ì‘ì—…ì¼ìë¥¼ í™•ì¸/ì„ íƒí•©ë‹ˆë‹¤',
                        'â‘¡ ê¸ˆìƒ‰ í…Œë‘ë¦¬ë¡œ ê°•ì¡°ëœ ê¸°ë‘¥(ì£¼ê¸°ë‘¥ì¡°ë¦½ì™„ë£Œ ìƒíƒœ)ì„ í´ë¦­í•©ë‹ˆë‹¤',
                        'â‘¢ ì†Œë¶€ì¬ì¡°ë¦½ ì™„ë£Œëœ ê¸°ë‘¥ì„ í™•ì¸ í›„ ì €ì¥í•©ë‹ˆë‹¤'
                    ],
                    note: 'â€» ì£¼ê¸°ë‘¥ì¡°ë¦½(3ë‹¨ê³„)ì´ ì™„ë£Œëœ ê¸°ë‘¥ë§Œ ì†Œë¶€ì¬ì¡°ë¦½ ì²˜ë¦¬ ê°€ëŠ¥'
                },
                5: {
                    title: 'ğŸŸ£ í˜„ì¥ë°°ì†¡ ì…ë ¥ ì•ˆë‚´',
                    company: 'ì£¼ì‹ ì‚°ì—…',
                    steps: [
                        'â‘  ì‘ì—…ì¼ìë¥¼ í™•ì¸/ì„ íƒí•©ë‹ˆë‹¤',
                        'â‘¡ ê¸ˆìƒ‰ í…Œë‘ë¦¬ë¡œ ê°•ì¡°ëœ ê¸°ë‘¥(ì†Œë¶€ì¬ì¡°ë¦½ì™„ë£Œ ìƒíƒœ)ì„ í´ë¦­í•©ë‹ˆë‹¤',
                        'â‘¢ í˜„ì¥ë°°ì†¡ ì™„ë£Œëœ ê¸°ë‘¥ì„ í™•ì¸ í›„ ì €ì¥í•©ë‹ˆë‹¤'
                    ],
                    note: 'â€» ì†Œë¶€ì¬ì¡°ë¦½(4ë‹¨ê³„)ì´ ì™„ë£Œëœ ê¸°ë‘¥ë§Œ ë°°ì†¡ ì²˜ë¦¬ ê°€ëŠ¥'
                },
                6: {
                    title: 'ğŸŸ¢ í˜„ì¥ì„¤ì¹˜ ì…ë ¥ ì•ˆë‚´',
                    company: 'ì§„í¥ê¸°ì—…',
                    steps: [
                        'â‘  ì‘ì—…ì¼ìë¥¼ í™•ì¸/ì„ íƒí•©ë‹ˆë‹¤',
                        'â‘¡ ê¸ˆìƒ‰ í…Œë‘ë¦¬ë¡œ ê°•ì¡°ëœ ê¸°ë‘¥(ë°°ì†¡ì™„ë£Œ ìƒíƒœ)ì„ í´ë¦­í•©ë‹ˆë‹¤',
                        'â‘¢ ì„¤ì¹˜ ì™„ë£Œëœ ê¸°ë‘¥ì„ í™•ì¸ í›„ ì €ì¥í•©ë‹ˆë‹¤'
                    ],
                    note: 'â€» í˜„ì¥ë°°ì†¡(5ë‹¨ê³„)ì´ ì™„ë£Œëœ ê¸°ë‘¥ë§Œ ì„¤ì¹˜ ì²˜ë¦¬ ê°€ëŠ¥'
                }
            };
            
            const guide = guideMessages[processId];
            const guideDiv = document.getElementById('process-guide');
            
            guideDiv.innerHTML = `
                <div style="margin-bottom:10px;">
                    <strong style="font-size:14px;color:#1565c0;">${guide.title}</strong>
                    <span style="margin-left:10px;padding:3px 8px;background:#e3f2fd;border-radius:4px;font-size:11px;color:#1976d2;">ë‹´ë‹¹: ${guide.company}</span>
                </div>
                <div style="margin-bottom:8px;font-size:12px;color:#555;">
                    ${guide.steps.map(step => `<div style="margin:3px 0;">${step}</div>`).join('')}
                </div>
                <div style="font-size:11px;color:#e65100;background:#fff3e0;padding:6px 10px;border-radius:4px;">
                    ${guide.note}
                </div>
            `;
        }

        // ê¸°ì¡´ í˜¸í™˜ì„±ì„ ìœ„í•œ í•¨ìˆ˜
        function selectCompany(company) {
            // ì²« ë²ˆì§¸ ê³µì •ìœ¼ë¡œ ìë™ ì„ íƒ
            if (company === 'yuseok') selectProcess(1);
            else if (company === 'jusin') selectProcess(3);
            else if (company === 'jinhung') selectProcess(5);
        }

        // Panel Navigation
        function showPanel(panelId) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById('panel-' + panelId).classList.add('active');
            event.target.classList.add('active');
            
            if (panelId === 'gantt') {
                renderGanttChart();
            } else if (panelId === 'chart') {
                renderCharts();
            } else if (panelId === 'overview') {
                renderColumnGrid('column-grid-overview');
                updateProgressBars();
            }
        }

        // Set Today's Date
        function setToday() {
            const today = new Date();
            const dateStr = today.toISOString().split('T')[0];
            document.getElementById('work-date').value = dateStr;
        }

        // Render Column Grid
        function renderColumnGrid(containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            let availableCount = 0;
            let completedCount = 0;
            
            // íœ´ë¬´ì¼ ì²´í¬ (ì…ë ¥ íŒ¨ë„ìš©)
            const workDate = document.getElementById('work-date')?.value;
            const isHolidayToday = workDate && isHoliday(workDate);
            
            for (let i = 1; i <= TOTAL_COLUMNS; i++) {
                const status = columnData[i]?.status || 0;
                const statusNames = ['ë¯¸ì°©ìˆ˜', 'ì»¤íŒ…', 'ì†Œë¶€ì¬', 'ì¡°ë¦½', 'ì†Œì¡°ë¦½', 'ë°°ì†¡', 'ì„¤ì¹˜ì™„ë£Œ'];
                
                const div = document.createElement('div');
                div.className = `column-item status-${status}`;
                
                // ì…ë ¥ íŒ¨ë„ì—ì„œ íœ´ë¬´ì¼ì´ë©´ ì „ì²´ ë¹„í™œì„±í™”
                if (containerId === 'column-grid-input' && isHolidayToday) {
                    div.style.opacity = '0.4';
                    div.style.cursor = 'not-allowed';
                    div.style.background = '#ffcdd2';
                }
                // ì…ë ¥ íŒ¨ë„ì—ì„œ ì„ íƒ ê°€ëŠ¥í•œ ê¸°ë‘¥ ê°•ì¡° í‘œì‹œ
                else if (containerId === 'column-grid-input' && currentProcess) {
                    const canProcess = (status === currentProcess - 1);
                    if (canProcess) {
                        div.style.boxShadow = '0 0 0 3px #ffd700, 0 0 10px rgba(255,215,0,0.5)';
                        div.style.animation = 'pulse 1.5s infinite';
                        availableCount++;
                    } else if (status >= currentProcess) {
                        div.style.opacity = '0.5';
                        completedCount++;
                    }
                }
                
                div.innerHTML = `
                    <span class="col-num">C${i.toString().padStart(2, '0')}</span>
                    <span class="col-status">${statusNames[status]}</span>
                `;
                
                if (containerId === 'column-grid-input') {
                    div.onclick = () => openColumnModal(i);
                }
                
                container.appendChild(div);
            }
            
            // ê°€ì´ë“œ í†µê³„ ì—…ë°ì´íŠ¸
            if (containerId === 'column-grid-input') {
                const statsDiv = document.getElementById('guide-stats');
                if (isHolidayToday) {
                    // íœ´ë¬´ì¼ ë©”ì‹œì§€
                    statsDiv.style.display = 'block';
                    statsDiv.style.background = '#ffcdd2';
                    statsDiv.style.color = '#c62828';
                    statsDiv.innerHTML = `<strong>ğŸš« ${getHolidayName(workDate)}</strong> - í•´ë‹¹ì¼ì€ ì‘ì—…ì„ ì…ë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`;
                } else if (currentProcess) {
                    const processNames = ['', 'ì£¼ê¸°ë‘¥ì»¤íŒ…', 'ê¸°ë‘¥ì†Œë¶€ì¬ê°€ê³µ', 'ì£¼ê¸°ë‘¥ì¡°ë¦½', 'ì†Œë¶€ì¬ì¡°ë¦½', 'í˜„ì¥ë°°ì†¡', 'í˜„ì¥ì„¤ì¹˜'];
                    statsDiv.style.display = 'block';
                    statsDiv.style.background = '#e8f5e9';
                    statsDiv.style.color = '#2e7d32';
                    statsDiv.innerHTML = 
                        `ğŸ“Š <strong>${processNames[currentProcess]}</strong> - ì…ë ¥ ê°€ëŠ¥: <strong style="color:#f57c00;">${availableCount}ê°œ</strong> / ì™„ë£Œ: <strong style="color:#4caf50;">${completedCount}ê°œ</strong> / ëŒ€ê¸°: <strong style="color:#757575;">${TOTAL_COLUMNS - availableCount - completedCount}ê°œ</strong>`;
                } else {
                    statsDiv.style.display = 'none';
                }
            }
        }

        // Open Column Modal
        function openColumnModal(columnId) {
            // íœ´ë¬´ì¼ ì²´í¬
            const workDate = document.getElementById('work-date').value;
            if (isHoliday(workDate)) {
                alert(`${getHolidayName(workDate)}\n\ní•´ë‹¹ì¼ì€ íœ´ë¬´ë¡œ ì‘ì—… ì…ë ¥ì´ ë¶ˆê°€í•©ë‹ˆë‹¤.`);
                return;
            }
            
            if (!currentProcess) {
                alert('ë¨¼ì € ì…ë ¥í•  ê³µì •ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const currentStatus = columnData[columnId]?.status || 0;
            
            // ì„ íƒí•œ ê³µì •ì´ í˜„ì¬ ê¸°ë‘¥ì— ì ìš© ê°€ëŠ¥í•œì§€ í™•ì¸
            // í•´ë‹¹ ê³µì •ì˜ ì´ì „ ê³µì •ì´ ì™„ë£Œë˜ì–´ì•¼ í•¨
            if (currentProcess > 1 && currentStatus < currentProcess - 1) {
                alert(`ì´ì „ ê³µì •(${currentProcess - 1}ë‹¨ê³„)ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`);
                return;
            }
            
            // ì´ë¯¸ í•´ë‹¹ ê³µì • ì´ìƒì´ ì™„ë£Œëœ ê²½ìš°
            if (currentStatus >= currentProcess) {
                alert(`ì´ ê¸°ë‘¥ì€ ì´ë¯¸ ${currentProcess}ë‹¨ê³„ ì´ìƒ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                return;
            }
            
            selectedColumn = columnId;
            document.getElementById('modal-column-num').textContent = 'C' + columnId.toString().padStart(2, '0');
            
            // í˜„ì¬ ì„ íƒëœ ê³µì •ë§Œ í‘œì‹œ
            const processNames = ['ë¯¸ì°©ìˆ˜', 'ì£¼ê¸°ë‘¥ì»¤íŒ…', 'ê¸°ë‘¥ì†Œë¶€ì¬ê°€ê³µ', 'ì£¼ê¸°ë‘¥ì¡°ë¦½', 'ì†Œë¶€ì¬ì¡°ë¦½', 'í˜„ì¥ë°°ì†¡', 'í˜„ì¥ì„¤ì¹˜'];
            document.getElementById('modal-process-select').innerHTML = `
                <option value="${currentProcess}">${currentProcess}. ${processNames[currentProcess]} ì™„ë£Œ</option>
            `;
            document.getElementById('modal-process-select').value = currentProcess;
            document.getElementById('modal-note').value = '';
            
            document.getElementById('column-modal').classList.add('active');
        }

        // Close Modal
        function closeModal() {
            document.getElementById('column-modal').classList.remove('active');
            selectedColumn = null;
        }

        // Save Column Status
        function saveColumnStatus() {
            const newStatus = currentProcess; // í˜„ì¬ ì„ íƒëœ ê³µì •ìœ¼ë¡œ ì„¤ì •
            const note = document.getElementById('modal-note').value;
            const workDate = document.getElementById('work-date').value;
            
            // Save data
            if (!columnData[selectedColumn]) {
                columnData[selectedColumn] = {};
            }
            columnData[selectedColumn].status = newStatus;
            columnData[selectedColumn].note = note;
            columnData[selectedColumn].lastUpdate = workDate;
            columnData[selectedColumn].updatedBy = PROCESSES.find(p => p.id === newStatus)?.company;
            
            // Track daily progress
            if (!dailyData[workDate]) {
                dailyData[workDate] = {};
            }
            if (!dailyData[workDate][newStatus]) {
                dailyData[workDate][newStatus] = [];
            }
            if (!dailyData[workDate][newStatus].includes(selectedColumn)) {
                dailyData[workDate][newStatus].push(selectedColumn);
            }
            
            closeModal();
            renderColumnGrid('column-grid-input');
            renderColumnGrid('column-grid-overview');
            updateProgressBars();
            saveToStorage();
            
            showConnectionStatus(`âœ… C${selectedColumn.toString().padStart(2,'0')} - ${newStatus}ë‹¨ê³„ ì™„ë£Œ!`);
        }

        // Update Progress Bars
        function updateProgressBars() {
            for (let p = 1; p <= 6; p++) {
                let count = 0;
                for (let c = 1; c <= TOTAL_COLUMNS; c++) {
                    if (columnData[c]?.status >= p) count++;
                }
                const percent = Math.round((count / TOTAL_COLUMNS) * 100);
                
                document.getElementById(`progress-p${p}`).style.width = percent + '%';
                document.getElementById(`progress-p${p}`).textContent = percent + '%';
                document.getElementById(`progress-p${p}-text`).textContent = `${count} / ${TOTAL_COLUMNS}`;
            }
        }

        // Render Gantt Chart
        // íœ´ë¬´ì¼ ì²´í¬ í—¬í¼ í•¨ìˆ˜
        function isHoliday(dateStr) {
            return HOLIDAYS.hasOwnProperty(dateStr);
        }
        
        function getHolidayName(dateStr) {
            return HOLIDAYS[dateStr] || '';
        }

        function renderGanttChart() {
            const table = document.getElementById('gantt-table');
            
            // Generate date range
            const dates = [];
            let currentDate = new Date(START_DATE);
            while (currentDate <= END_DATE) {
                dates.push(new Date(currentDate));
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            // Build header
            let headerHtml = '<thead><tr><th class="col-header">ê¸°ë‘¥ë²ˆí˜¸</th>';
            dates.forEach(date => {
                const dayOfWeek = date.getDay();
                const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
                const dateStrFull = date.toISOString().split('T')[0];
                const isHolidayDate = isHoliday(dateStrFull);
                const dateStr = `${date.getMonth()+1}/${date.getDate()}`;
                
                let headerClass = 'date-header';
                if (isHolidayDate) {
                    headerClass += ' holiday-header';
                } else if (isWeekend) {
                    headerClass += ' weekend';
                }
                
                headerHtml += `<th class="${headerClass}" title="${isHolidayDate ? getHolidayName(dateStrFull) : ''}">${dateStr}</th>`;
            });
            headerHtml += '</tr></thead>';
            
            // Build body
            let bodyHtml = '<tbody>';
            for (let c = 1; c <= TOTAL_COLUMNS; c++) {
                bodyHtml += `<tr><td class="col-name">C${c.toString().padStart(2, '0')}</td>`;
                
                dates.forEach(date => {
                    const dateStr = date.toISOString().split('T')[0];
                    const dayOfWeek = date.getDay();
                    const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
                    const isHolidayDate = isHoliday(dateStr);
                    
                    // íœ´ë¬´ì¼ì¸ ê²½ìš°
                    if (isHolidayDate) {
                        bodyHtml += `<td class="holiday" title="${getHolidayName(dateStr)}">`;
                        if (c === 1) {
                            // ì²« ë²ˆì§¸ í–‰ì—ë§Œ íœ´ë¬´ ë¼ë²¨ í‘œì‹œ
                        }
                        bodyHtml += '</td>';
                    } else {
                        // Find which process was completed on this date for this column
                        let cellClass = '';
                        for (let p = 1; p <= 6; p++) {
                            if (dailyData[dateStr]?.[p]?.includes(c)) {
                                cellClass = `gantt-cell p${p}`;
                                break;
                            }
                        }
                        
                        bodyHtml += `<td class="${isWeekend ? 'weekend' : ''}">`;
                        if (cellClass) {
                            bodyHtml += `<div class="${cellClass}"></div>`;
                        }
                        bodyHtml += '</td>';
                    }
                });
                
                bodyHtml += '</tr>';
            }
            bodyHtml += '</tbody>';
            
            table.innerHTML = headerHtml + bodyHtml;
        }

        // Render Charts
        function renderCharts() {
            renderProgressChart();
            renderCompanyChart();
        }

        function renderProgressChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            
            // Generate date labels and data
            const dates = [];
            const datasets = [];
            const colors = ['#e74c3c', '#ff9800', '#2196f3', '#00bcd4', '#9c27b0', '#4caf50'];
            const processNames = ['ì£¼ê¸°ë‘¥ì»¤íŒ…', 'ì†Œë¶€ì¬ê°€ê³µ', 'ì£¼ê¸°ë‘¥ì¡°ë¦½', 'ì†Œë¶€ì¬ì¡°ë¦½', 'í˜„ì¥ë°°ì†¡', 'í˜„ì¥ì„¤ì¹˜'];
            
            let currentDate = new Date(START_DATE);
            while (currentDate <= new Date()) {
                dates.push(currentDate.toISOString().split('T')[0]);
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            // Calculate cumulative data for each process
            for (let p = 1; p <= 6; p++) {
                const data = [];
                let cumulative = 0;
                
                dates.forEach(dateStr => {
                    if (dailyData[dateStr]?.[p]) {
                        cumulative += dailyData[dateStr][p].length;
                    }
                    data.push(cumulative);
                });
                
                datasets.push({
                    label: processNames[p-1],
                    data: data,
                    borderColor: colors[p-1],
                    backgroundColor: colors[p-1] + '20',
                    fill: true,
                    tension: 0.3
                });
            }
            
            if (progressChart) progressChart.destroy();
            
            progressChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates.map(d => d.substring(5)),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: TOTAL_COLUMNS,
                            title: {
                                display: true,
                                text: 'ì™„ë£Œ ê¸°ë‘¥ ìˆ˜'
                            }
                        }
                    }
                }
            });
        }

        function renderCompanyChart() {
            const ctx = document.getElementById('companyChart').getContext('2d');
            
            // Calculate company progress
            const companyProgress = {
                'yuseok': { p1: 0, p2: 0 },
                'jusin': { p3: 0, p4: 0 },
                'jinhung': { p5: 0 }
            };
            
            for (let c = 1; c <= TOTAL_COLUMNS; c++) {
                const status = columnData[c]?.status || 0;
                if (status >= 1) companyProgress.yuseok.p1++;
                if (status >= 2) companyProgress.yuseok.p2++;
                if (status >= 3) companyProgress.jusin.p3++;
                if (status >= 4) companyProgress.jusin.p4++;
                if (status >= 5) companyProgress.jinhung.p5++;
            }
            
            if (companyChart) companyChart.destroy();
            
            companyChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['ìœ ì„ì² ê°•\n(ì»¤íŒ…)', 'ìœ ì„ì² ê°•\n(ì†Œë¶€ì¬)', 'ì£¼ì‹ ì‚°ì—…\n(ì¡°ë¦½)', 'ì£¼ì‹ ì‚°ì—…\n(ë°°ì†¡)', 'ì§„í¥ê¸°ì—…\n(ì„¤ì¹˜)'],
                    datasets: [{
                        label: 'ì™„ë£Œ ê¸°ë‘¥ ìˆ˜',
                        data: [
                            companyProgress.yuseok.p1,
                            companyProgress.yuseok.p2,
                            companyProgress.jusin.p3,
                            companyProgress.jusin.p4,
                            companyProgress.jinhung.p5
                        ],
                        backgroundColor: ['#e74c3c', '#ff9800', '#2196f3', '#9c27b0', '#4caf50']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: TOTAL_COLUMNS,
                            title: {
                                display: true,
                                text: 'ì™„ë£Œ ê¸°ë‘¥ ìˆ˜'
                            }
                        }
                    }
                }
            });
        }

        // Save/Load Data
        function saveData() {
            saveToStorage();
        }

        function saveToStorage() {
            if (isFirebaseEnabled) {
                // Firebaseì— ì €ì¥
                db.ref('kcolumn/columnData').set(columnData)
                    .then(() => {
                        return db.ref('kcolumn/dailyData').set(dailyData);
                    })
                    .then(() => {
                        showConnectionStatus('âœ… ì €ì¥ ì™„ë£Œ! (ì‹¤ì‹œê°„ ë™ê¸°í™”)');
                    })
                    .catch((error) => {
                        console.error('Firebase ì €ì¥ ì˜¤ë¥˜:', error);
                        alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                    });
            } else {
                // localStorageì— ì €ì¥
                localStorage.setItem('steelColumnData', JSON.stringify(columnData));
                localStorage.setItem('steelColumnDaily', JSON.stringify(dailyData));
                showConnectionStatus('âœ… ë¡œì»¬ì— ì €ì¥ë¨');
            }
        }

        function loadFromLocalStorage() {
            const savedColumnData = localStorage.getItem('steelColumnData');
            const savedDailyData = localStorage.getItem('steelColumnDaily');
            
            if (savedColumnData) {
                columnData = JSON.parse(savedColumnData);
            }
            if (savedDailyData) {
                dailyData = JSON.parse(savedDailyData);
            }
        }

        function exportData() {
            const exportObj = {
                columnData: columnData,
                dailyData: dailyData,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(exportObj, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `kcolumn-data-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
        }

        // JSON íŒŒì¼ ê°€ì ¸ì˜¤ê¸°
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    columnData = data.columnData || {};
                    dailyData = data.dailyData || {};
                    saveToStorage();
                    renderColumnGrid('column-grid-overview');
                    renderColumnGrid('column-grid-input');
                    updateProgressBars();
                    alert('ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.');
                } catch (error) {
                    alert('íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                }
            };
            reader.readAsText(file);
        }

        function loadDayData() {
            const workDate = document.getElementById('work-date').value;
            
            // íœ´ë¬´ì¼ ì²´í¬
            if (isHoliday(workDate)) {
                const holidayName = getHolidayName(workDate);
                showConnectionStatus(`ğŸ”´ ${workDate}: ${holidayName} - ì‘ì—… ì…ë ¥ ë¶ˆê°€`);
            }
            
            renderColumnGrid('column-grid-input');
        }

        // Close modal on outside click
        document.getElementById('column-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>
