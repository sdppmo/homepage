<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cross H Column Calculation - Print</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', 'Segoe UI', Arial, sans-serif;
            font-size: 9px;
            padding: 0;
            background: #f0f0f0;
            line-height: 1.3;
        }

        .page {
            width: 210mm;
            height: 297mm;
            margin: 0 auto 10px;
            background: white;
            padding: 6mm 8mm;
            position: relative;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            page-break-after: always;
            overflow: hidden;
        }

        .page:last-child {
            page-break-after: auto;
        }

        /* Watermark */
        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 56px;
            font-weight: bold;
            color: rgba(44, 74, 124, 0.40);
            white-space: nowrap;
            pointer-events: none;
            z-index: 1;
            font-family: 'Georgia', 'Times New Roman', serif;
            letter-spacing: 6px;
        }

        .header {
            background: linear-gradient(135deg, #2c4a7c, #4a6fa5);
            color: white;
            padding: 8px 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            border-radius: 2px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 32px;
            height: 32px;
            background: white;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #2c4a7c;
            font-size: 7px;
        }

        .header-title {
            font-size: 13px;
            font-weight: bold;
            letter-spacing: 0.5px;
        }

        .header-name {
            font-size: 11px;
            font-weight: 500;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 264px;
            gap: 10px;
            margin-bottom: 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 8.5px;
        }

        table td, table th {
            padding: 3px 6px;
            border: 1px solid #bbb;
            vertical-align: middle;
        }

        .header-row td {
            background: #e8e8e8;
            font-weight: 600;
        }

        .label-cell {
            background: #f5f5f5;
            font-weight: 500;
            width: 130px;
            color: #333;
        }

        .sub-label {
            padding-left: 20px !important;
            background: #fafafa;
        }

        .value-cell {
            background: white;
        }

        .blue-cell {
            background: #cce0f0;
            text-align: center;
            font-weight: 500;
            color: #1a3a5c;
        }

        .yellow-cell {
            background: #ffffc0;
            text-align: right;
            font-weight: 500;
            padding-right: 8px !important;
        }

        .green-text {
            color: #006600;
            font-weight: bold;
        }

        .red-text {
            color: #cc0000;
            font-weight: bold;
        }

        .diagram-section {
            border: 1px solid #bbb;
            padding: 10px;
            background: #fafafa;
        }

        .diagram-title {
            text-align: center;
            font-weight: bold;
            font-size: 11px;
            margin-bottom: 8px;
            color: #2c4a7c;
        }

        .cross-section {
            position: relative;
            width: 168px;
            height: 168px;
            margin: 0 auto 10px;
            background: white;
            border: 1px solid #ddd;
        }

        .h1-web, .h1-flange-top, .h1-flange-bottom,
        .h2-web, .h2-flange-left, .h2-flange-right {
            position: absolute;
            box-sizing: border-box;
        }

        .h1-web, .h1-flange-top, .h1-flange-bottom {
            background: #a8c8e8;
            border: 1px solid #5588bb;
        }

        .h2-web, .h2-flange-left, .h2-flange-right {
            background: #c8e8a8;
            border: 1px solid #66aa55;
        }

        .dim-label {
            position: absolute;
            font-size: 8px;
            font-weight: bold;
            color: #333;
        }

        .props-table {
            font-size: 9px;
            margin-top: 6px;
        }

        .props-table td {
            padding: 2px 4px;
            border: none;
            background: transparent;
        }

        .props-table .prop-label {
            font-weight: 500;
            color: #555;
            width: 28px;
        }

        .props-table .prop-value {
            text-align: right;
            color: #1a3a5c;
            font-weight: 500;
        }

        .section-header {
            background: linear-gradient(135deg, #2c4a7c, #4a6fa5);
            color: white;
            padding: 4px 10px;
            font-weight: bold;
            font-size: 10px;
            margin: 10px 0 6px 0;
            border-radius: 2px;
        }

        .subsection-header {
            font-weight: bold;
            font-size: 9px;
            margin: 6px 0 4px 8px;
            color: #2c4a7c;
            border-bottom: 1px solid #ccc;
            padding-bottom: 2px;
        }

        .sub-subsection {
            font-weight: 600;
            font-size: 8.5px;
            margin: 5px 0 3px 16px;
            color: #444;
        }

        .calc-row {
            display: flex;
            align-items: center;
            padding: 2px 0;
            margin-left: 15px;
            font-size: 8.5px;
        }

        .calc-formula {
            width: 260px;
            color: #333;
        }

        .calc-eq {
            width: 15px;
            text-align: center;
        }

        .calc-value {
            background: #ffffc0;
            padding: 2px 6px;
            text-align: right;
            min-width: 55px;
            border: 1px solid #ccc;
            font-weight: 500;
        }

        .calc-unit {
            margin-left: 4px;
            color: #666;
            min-width: 50px;
        }

        .calc-compare {
            margin-left: 8px;
            color: #444;
        }

        .calc-result {
            margin-left: 8px;
            font-weight: bold;
        }

        .footer {
            position: absolute;
            bottom: 6mm;
            left: 8mm;
            right: 8mm;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 7px;
            color: #666;
            border-top: 1px solid #ccc;
            padding-top: 4px;
        }

        .footer-logo {
            font-weight: bold;
            color: #2c4a7c;
        }

        @media print {
            @page { size: A4; margin: 0; }
            body { padding: 0; background: white; }
            .page { width: 210mm; height: 297mm; box-shadow: none; margin: 0; }
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; color-adjust: exact !important; }
            .watermark {
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                color: rgba(44, 74, 124, 0.15) !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }

        @media screen {
            body { padding: 10px; }
        }
    </style>
</head>
<body>
    <!-- Page 1 -->
    <div class="page" id="page1">
        <div class="watermark">SongDo Partners</div>
        <div class="header">
            <div class="header-left">
                <div class="logo">K-COL</div>
                <span class="header-title">CROSS H COLUMN CALCULATION DATA</span>
            </div>
            <div class="header-name">NAME: <span id="projectName1">K-COL</span></div>
        </div>

        <div class="main-grid">
            <div>
                <table>
                    <tr class="header-row">
                        <td colspan="4" style="text-align:center;">Design Information</td>
                    </tr>
                    <tr>
                        <td class="label-cell">Design Code</td>
                        <td class="value-cell" colspan="3">KDS 14 31 00 (LRFD), BS 5950-1:2000</td>
                    </tr>
                    <tr>
                        <td class="label-cell">Major Section</td>
                        <td class="blue-cell" id="majorSection">450×200×9×14</td>
                        <td class="label-cell">Minor Section</td>
                        <td class="blue-cell" id="minorSection">450×200×9×14</td>
                    </tr>
                    <tr>
                        <td class="label-cell">Add.Plate on Major</td>
                        <td class="value-cell" colspan="3">Not Supported.</td>
                    </tr>
                </table>

                <table style="margin-top:6px;">
                    <tr>
                        <td class="label-cell">Steel Material</td>
                        <td class="blue-cell" id="steelGrade" style="width:80px;">SM355</td>
                        <td></td>
                        <td class="sub-label">Fy</td>
                        <td class="yellow-cell" id="FyValue">355</td>
                        <td>MPa</td>
                    </tr>
                    <tr>
                        <td class="sub-label">E</td>
                        <td class="yellow-cell" id="EValue">210,000</td>
                        <td>MPa</td>
                        <td class="sub-label">ν</td>
                        <td class="yellow-cell" id="nuValue">0.3</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="label-cell">Unbraced Length</td>
                        <td colspan="2"></td>
                        <td class="label-cell">Effective Length Factor</td>
                        <td colspan="2"></td>
                    </tr>
                    <tr>
                        <td class="sub-label">Lx</td>
                        <td class="blue-cell" id="LxValue">9.050</td>
                        <td>m</td>
                        <td class="sub-label">Kx</td>
                        <td class="blue-cell" id="KxValue">0.8</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="sub-label">Ly</td>
                        <td class="blue-cell" id="LyValue">9.050</td>
                        <td>m</td>
                        <td class="sub-label">Ky</td>
                        <td class="blue-cell" id="KyValue">0.8</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="sub-label">Lb</td>
                        <td class="blue-cell" id="LbValue">9.050</td>
                        <td>m</td>
                        <td class="sub-label">Kz</td>
                        <td class="blue-cell" id="KzValue">0.8</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td class="label-cell">Lateral Buckling Mod. Factor</td>
                        <td class="sub-label">Cb</td>
                        <td class="blue-cell" id="CbValue">1</td>
                        <td colspan="3"></td>
                    </tr>
                    <tr>
                        <td class="label-cell" colspan="6">Design Load</td>
                    </tr>
                    <tr>
                        <td class="sub-label">Pu</td>
                        <td class="yellow-cell" id="PuValue">4,453</td>
                        <td>kN</td>
                        <td class="sub-label">Vux</td>
                        <td class="yellow-cell" id="VuxValue">0.00</td>
                        <td>kN</td>
                    </tr>
                    <tr>
                        <td class="sub-label">Mux</td>
                        <td class="yellow-cell" id="MuxValue">0.00</td>
                        <td>kN·m</td>
                        <td class="sub-label">Vuy</td>
                        <td class="yellow-cell" id="VuyValue">0.00</td>
                        <td>kN</td>
                    </tr>
                    <tr>
                        <td class="sub-label">Muy</td>
                        <td class="yellow-cell" id="MuyValue">0.00</td>
                        <td>kN·m</td>
                        <td colspan="3"></td>
                    </tr>
                </table>
            </div>

            <div class="diagram-section">
                <div class="diagram-title">Section Properties</div>
                <div class="cross-section" id="crossSection">
                    <div class="h1-web"></div>
                    <div class="h1-flange-top"></div>
                    <div class="h1-flange-bottom"></div>
                    <div class="h2-web"></div>
                    <div class="h2-flange-left"></div>
                    <div class="h2-flange-right"></div>
                    <div class="dim-label" style="right:-16px;top:50%;transform:translateY(-50%);">H1</div>
                    <div class="dim-label" style="bottom:-12px;left:50%;transform:translateX(-50%);">B1</div>
                    <div class="dim-label" style="left:-16px;top:50%;transform:translateY(-50%);">H2</div>
                </div>
                <table class="props-table">
                    <tr><td class="prop-label">H1</td><td class="prop-value" id="p_H1">450.0</td><td>mm</td><td class="prop-label">H2</td><td class="prop-value" id="p_H2">450.0</td><td>mm</td></tr>
                    <tr><td class="prop-label">B1</td><td class="prop-value" id="p_B1">200.0</td><td>mm</td><td class="prop-label">B2</td><td class="prop-value" id="p_B2">200.0</td><td>mm</td></tr>
                    <tr><td class="prop-label">tw1</td><td class="prop-value" id="p_tw1">9.0</td><td>mm</td><td class="prop-label">tw2</td><td class="prop-value" id="p_tw2">9.0</td><td>mm</td></tr>
                    <tr><td class="prop-label">tf1</td><td class="prop-value" id="p_tf1">14.0</td><td>mm</td><td class="prop-label">tf2</td><td class="prop-value" id="p_tf2">14.0</td><td>mm</td></tr>
                    <tr><td class="prop-label">r1</td><td class="prop-value" id="p_r1">18.0</td><td>mm</td><td class="prop-label">r2</td><td class="prop-value" id="p_r2">18.0</td><td>mm</td></tr>
                </table>
                <table class="props-table" style="margin-top:4px;border-top:1px solid #ddd;padding-top:4px;">
                    <tr><td class="prop-label">Ag</td><td class="prop-value" colspan="5" id="p_Ag">19,271.2 mm²</td></tr>
                    <tr><td class="prop-label">Ix</td><td class="prop-value" id="p_Ix">353,065,694</td><td>mm⁴</td><td class="prop-label">Iy</td><td class="prop-value" id="p_Iy">353,065,694</td><td>mm⁴</td></tr>
                    <tr><td class="prop-label">Zx</td><td class="prop-value" id="p_Zx">1,901,489</td><td>mm³</td><td class="prop-label">Zy</td><td class="prop-value" id="p_Zy">1,901,489</td><td>mm³</td></tr>
                    <tr><td class="prop-label">Sx</td><td class="prop-value" id="p_Sx">1,569,181</td><td>mm³</td><td class="prop-label">Sy</td><td class="prop-value" id="p_Sy">1,569,181</td><td>mm³</td></tr>
                    <tr><td class="prop-label">rx</td><td class="prop-value" id="p_rx">135.4</td><td>mm</td><td class="prop-label">ry</td><td class="prop-value" id="p_ry">135.4</td><td>mm</td></tr>
                    <tr><td class="prop-label">J</td><td class="prop-value" colspan="5" id="p_J">936,825 mm⁴</td></tr>
                </table>
            </div>
        </div>

        <!-- 1. SUMMARY -->
        <div class="section-header">1. SUMMARY</div>
        <table>
            <tr>
                <td class="label-cell" style="width:140px;">Compressive Strength</td>
                <td style="width:100px;">Pu / φPn</td>
                <td>=</td>
                <td class="yellow-cell" style="width:60px;" id="s_Pu">4,453</td>
                <td>/</td>
                <td class="yellow-cell" style="width:70px;" id="s_phiPn">5,015.36</td>
                <td>=</td>
                <td class="yellow-cell" style="width:55px;" id="s_compR">0.888</td>
                <td>≤</td>
                <td style="width:50px;">1.0</td>
                <td class="green-text" id="s_compOK">→ O.K</td>
            </tr>
            <tr>
                <td class="label-cell">Bending Strength</td>
                <td>Mux / φMnx</td>
                <td>=</td>
                <td class="yellow-cell" id="s_Mux">0.00</td>
                <td>/</td>
                <td class="yellow-cell" id="s_phiMnx">607.53</td>
                <td>=</td>
                <td class="yellow-cell" id="s_bendXR">0.000</td>
                <td>≤</td>
                <td>1.0</td>
                <td class="green-text" id="s_bendXOK">→ O.K</td>
            </tr>
            <tr>
                <td class="label-cell"></td>
                <td>Muy / φMny</td>
                <td>=</td>
                <td class="yellow-cell" id="s_Muy">0.00</td>
                <td>/</td>
                <td class="yellow-cell" id="s_phiMny">607.53</td>
                <td>=</td>
                <td class="yellow-cell" id="s_bendYR">0.000</td>
                <td>≤</td>
                <td>1.0</td>
                <td class="green-text" id="s_bendYOK">→ O.K</td>
            </tr>
            <tr>
                <td class="label-cell">P-M-M Combination</td>
                <td colspan="4">Pu/φPn + 8/9(Mux/φMnx + Muy/φMny)</td>
                <td>=</td>
                <td class="yellow-cell" id="s_pmmR1">0.888</td>
                <td>+</td>
                <td class="yellow-cell" id="s_pmmR2">0.888</td>
                <td>≤</td>
                <td>1.0</td>
                <td class="green-text" id="s_pmmOK">→ O.K</td>
            </tr>
            <tr>
                <td class="label-cell">Shear Strength</td>
                <td>Vux / φVnx</td>
                <td>=</td>
                <td class="yellow-cell" id="s_Vux">0.00</td>
                <td>/</td>
                <td class="yellow-cell" id="s_phiVnx">2,055.45</td>
                <td>=</td>
                <td class="yellow-cell" id="s_shearXR">0.000</td>
                <td>≤</td>
                <td>1.0</td>
                <td class="green-text" id="s_shearXOK">→ O.K</td>
            </tr>
            <tr>
                <td class="label-cell"></td>
                <td>Vuy / φVny</td>
                <td>=</td>
                <td class="yellow-cell" id="s_Vuy">0.00</td>
                <td>/</td>
                <td class="yellow-cell" id="s_phiVny">2,055.45</td>
                <td>=</td>
                <td class="yellow-cell" id="s_shearYR">0.000</td>
                <td>≤</td>
                <td>1.0</td>
                <td class="green-text" id="s_shearYOK">→ O.K</td>
            </tr>
        </table>

        <!-- 2. Compressive Strength -->
        <div class="section-header">2. Compressive Strength</div>
        <div class="subsection-header">Plate-Thickness ratio for Compression</div>
        <div class="calc-row">
            <span class="calc-formula">λcfr = 0.56 √(E / Fy)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_lcfr">13.62</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">λcf = B2 / 2 / tf2</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_lcf">7.14</span>
            <span class="calc-unit"></span>
            <span class="calc-compare">&lt; λcfr = <span id="c_lcfr2">13.62</span></span>
            <span class="calc-result green-text">→ Non-Slender</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">λcwr = 1.49 √(E / Fy)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_lcwr">36.24</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">λcw = {H2 - 2(tf2+r2) - tw2} / 2 / tw2</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_lcw">20.94</span>
            <span class="calc-unit"></span>
            <span class="calc-compare">&lt; λcwr = <span id="c_lcwr2">36.24</span></span>
            <span class="calc-result green-text">→ Non-Slender</span>
        </div>

        <div class="subsection-header">Euler Buckling Strength</div>
        <div class="calc-row">
            <span class="calc-formula">4.71 √(E / Fy)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_euler">114.55</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">KL/r = max(Kx×Lx/rx, Ky×Ly/ry)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_KLr">53.48</span>
            <span class="calc-unit"></span>
            <span class="calc-compare">&lt; <span id="c_euler2">114.55</span></span>
            <span class="calc-result green-text">→ Inelastic</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">Fe1 = π²E / (KL/r)²</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_Fe1">724.52</span>
            <span class="calc-unit">MPa</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">G = E / 2(1+ν)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_G">80,769.23</span>
            <span class="calc-unit">MPa</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">Fe2 = (π²E×Cw/(Kz×Lx)² + G×J) / (Ix+Iy)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_Fe2">1,245.00</span>
            <span class="calc-unit">MPa</span>
        </div>

        <div class="subsection-header">Compressive Strength</div>
        <div class="calc-row">
            <span class="calc-formula">Fcr = (0.658^(Fy/Fe)) × Fy</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_Fcr">289.22</span>
            <span class="calc-unit">MPa</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">φc = 0.9</span>
            <span class="calc-eq">=</span>
            <span class="calc-value">0.9</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">φcPn = φc × Ag × Fcr / 1000</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="c_phiPn">5,015.36</span>
            <span class="calc-unit">kN</span>
            <span class="calc-compare">&gt; Pu = <span id="c_Pu">4,453</span></span>
            <span class="calc-result green-text">→ O.K</span>
        </div>

        <div class="footer">
            <div>
                <span class="footer-logo">SDP licensed K-COL</span>
                <span style="margin-left:15px;">Cross H Official Fabricator by DONG YANG S·Tec</span>
            </div>
            <div>
                <span>Page 1 / 2</span>
                <span style="margin-left:12px;">Calculation Sheet Prepared by 송도파트너스피엠오</span>
                <span style="margin-left:12px;" id="printDate1"></span>
            </div>
        </div>
    </div>

    <!-- Page 2 -->
    <div class="page" id="page2">
        <div class="watermark">SongDo Partners</div>
        <div class="header">
            <div class="header-left">
                <div class="logo">K-COL</div>
                <span class="header-title">Cross H Column Calculation Data</span>
            </div>
            <div class="header-name">NAME: <span id="projectName2">K-COL</span></div>
        </div>

        <!-- 3. Flexural Strength -->
        <div class="section-header">3. Flexural Strength</div>
        
        <div class="subsection-header">Major Axis</div>
        <div class="sub-subsection">Plate-Thickness ratio for Flexure</div>
        <div class="calc-row">
            <span class="calc-formula">λffp = 0.38 √(E / Fy)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_lfp">9.24</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">λffr = 1.00 √(E / Fy)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_lfr">24.32</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">λff1 = B1 / 2 / tf1</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_lf1">7.14</span>
            <span class="calc-unit"></span>
            <span class="calc-compare" id="f_lf1Compare">&lt; λffp = <span id="f_lfp2">9.24</span></span>
            <span class="calc-result green-text" id="f_lf1Result">→ Compact</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">λfwp = 3.76 √(E / Fy)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_lwp">91.45</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">λfwr = 5.70 √(E / Fy)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_lwr">138.63</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">λfw1 = (H1-2(tf1+r1)-tw1)/2/tw1</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_lw1">20.94</span>
            <span class="calc-unit"></span>
            <span class="calc-compare" id="f_lw1Compare">&lt; λfwp = <span id="f_lwp2">91.45</span></span>
            <span class="calc-result green-text" id="f_lw1Result">→ Compact</span>
        </div>

        <div class="sub-subsection">Section Yielding Strength</div>
        <div class="calc-row">
            <span class="calc-formula">Mpx = min[Fy×Zx, 1.6×Fy×Sx]</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_Mpx">675.03</span>
            <span class="calc-unit">kN·m</span>
        </div>

        <div class="sub-subsection">Lateral-Torsional Buckling</div>
        <div class="calc-row">
            <span class="calc-formula">rtsx = √[√(Iy×Cw) / Sx]</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_rtsx">221.47</span>
            <span class="calc-unit">mm</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">ho1 = (H1 - tf1) / 2</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_ho1">218.0</span>
            <span class="calc-unit">mm</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">Lp = 1.76×ry×√(E/Fy)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_Lp">5.794</span>
            <span class="calc-unit">m</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula" style="font-size:7.5px;">Lr1 = 1.95rtsx(E/0.7Fy)×√{(Jc)/(Sx×ho1)}×√[1+√{1+6.76(...)²}]</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_Lr1">30.22</span>
            <span class="calc-unit">m</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">Mnx = Mpx</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_Mnx">675.03</span>
            <span class="calc-unit">kN·m</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">φbMnx</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_phiMnx">607.53</span>
            <span class="calc-unit">kN·m</span>
            <span class="calc-compare" id="f_compMnx">&gt; Mux = <span id="f_Mux">0.00</span></span>
            <span class="calc-result green-text" id="f_resultMnx">→ O.K</span>
        </div>

        <div class="subsection-header">Minor Axis</div>
        <div class="sub-subsection">Plate-Thickness ratio for Flexure</div>
        <div class="calc-row">
            <span class="calc-formula">λff2 = B2 / 2 / tf2</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_lf2">7.14</span>
            <span class="calc-unit"></span>
            <span class="calc-compare">&lt; λffp = <span id="f_lfp3">9.24</span></span>
            <span class="calc-result green-text">→ Compact</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">λfw2 = (H2-2(tf2+r2)-tw2)/2/tw2</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_lw2">20.94</span>
            <span class="calc-unit"></span>
            <span class="calc-compare" id="f_lw2Compare">&lt; λfwp = <span id="f_lwp3">91.45</span></span>
            <span class="calc-result green-text" id="f_lw2Result">→ Compact</span>
        </div>

        <div class="sub-subsection">Section Yielding Strength</div>
        <div class="calc-row">
            <span class="calc-formula">Mpy = min[Fy×Zy, 1.6×Fy×Sy]</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_Mpy">675.03</span>
            <span class="calc-unit">kN·m</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">φbMny</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="f_phiMny">607.53</span>
            <span class="calc-unit">kN·m</span>
            <span class="calc-compare" id="f_compMny">&gt; Muy = <span id="f_Muy">0.00</span></span>
            <span class="calc-result green-text" id="f_resultMny">→ O.K</span>
        </div>

        <!-- 4. P-M-M Combination Check -->
        <div class="section-header">4. P-M-M Combination Check</div>
        <div class="calc-row" style="margin-top:6px;">
            <span class="calc-formula">Pu / φcPn</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="pm_r1">0.888</span>
            <span class="calc-unit"></span>
            <span class="calc-compare">&gt; 0.20</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">Pu/φPn + 8/9×(Mux/φMnx + Muy/φMny)</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="pm_r2">0.888</span>
            <span class="calc-unit"></span>
            <span class="calc-compare">≤ 1.000</span>
            <span class="calc-result green-text" id="pm_result">→ O.K</span>
        </div>

        <!-- 5. Shear Strength -->
        <div class="section-header">5. Shear Strength</div>
        
        <div class="subsection-header">Major Axis</div>
        <div class="sub-subsection">Shear coefficient, Cv</div>
        <div class="calc-row">
            <span class="calc-formula">λvw = {H2-2(tf2+r2)-tw2}/2/tw2</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="v_lvw">20.94</span>
            <span class="calc-unit"></span>
            <span class="calc-compare">&lt; 2.24√(E/Fy) = <span id="v_lim">54.48</span></span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">Cvw = 1</span>
            <span class="calc-eq">=</span>
            <span class="calc-value">1.00</span>
        </div>

        <div class="sub-subsection">Shear Strength, φVn</div>
        <div class="calc-row">
            <span class="calc-formula">As1 = Aw + 2Af</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="v_As1">9,650.00</span>
            <span class="calc-unit">mm²</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">φvwVny = 0.6×Fy×As1×Cvw</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="v_phiVny">2,055.45</span>
            <span class="calc-unit">kN</span>
            <span class="calc-compare">&gt; Vuy = <span id="v_Vuy">0.00</span></span>
            <span class="calc-result green-text">→ O.K</span>
        </div>

        <div class="subsection-header">Minor Axis</div>
        <div class="sub-subsection">Shear Strength, φVn</div>
        <div class="calc-row">
            <span class="calc-formula">As2 = Aw + 2Af</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="v_As2">9,650.00</span>
            <span class="calc-unit">mm²</span>
        </div>
        <div class="calc-row">
            <span class="calc-formula">φvwVnx = 0.6×Fy×As2×Cvw</span>
            <span class="calc-eq">=</span>
            <span class="calc-value" id="v_phiVnx">2,055.45</span>
            <span class="calc-unit">kN</span>
            <span class="calc-compare">&gt; Vux = <span id="v_Vux">0.00</span></span>
            <span class="calc-result green-text">→ O.K</span>
        </div>

        <div class="footer">
            <div>
                <span class="footer-logo">SDP licensed K-COL</span>
                <span style="margin-left:15px;">Cross H Official Fabricator by DONG YANG S·Tec</span>
            </div>
            <div>
                <span>Page 2 / 2</span>
                <span style="margin-left:12px;">Calculation Sheet Prepared by 송도파트너스피엠오</span>
                <span style="margin-left:12px;" id="printDate2"></span>
            </div>
        </div>
    </div>

    <script>
        const data = JSON.parse(localStorage.getItem('kcolInputData')) || {
            H1:450,B1:200,tw1:9,tf1:14,r1:18,H2:450,B2:200,tw2:9,tf2:14,r2:18,
            steelGrade:'SM355',Fy:355,E:210000,nu:0.3,
            Lx:9.05,Ly:9.05,Lb:9.05,Kx:0.8,Ky:0.8,Kz:0.8,Cb:1.0,
            Pu:4453,Mux:0,Muy:0,Vux:0,Vuy:0,name:'K-COL'
        };

        const h1=data.H1,b1=data.B1,tw1=data.tw1,tf1=data.tf1,r1=data.r1;
        const h2=data.H2,b2=data.B2,tw2=data.tw2,tf2=data.tf2,r2=data.r2;
        const Fy=data.Fy,E=data.E,nu=data.nu;
        const Lx=data.Lx*1000,Ly=data.Ly*1000,Kx=data.Kx,Ky=data.Ky,Kz=data.Kz,Cb=data.Cb;
        const Pu=data.Pu,Mux=data.Mux,Muy=data.Muy,Vux=data.Vux,Vuy=data.Vuy;

        // Section properties
        const hw3=h1-2*tf1,hw6=h2-2*tf2;
        const d1=h1/2-tf1/2,d4=h2/2-tf2/2;
        const ag1=b1*tf1,ag4=b2*tf2;
        const ag7=4*(r1*r1-Math.PI*r1*r1/4),ag8=4*(r2*r2-Math.PI*r2*r2/4);
        const area=2*ag1+hw3*tw1+2*ag4+hw6*tw2+ag7+ag8-tw1*tw2;
        const Ix=2*(1/12*b1*Math.pow(tf1,3)+ag1*Math.pow(d1,2))+1/12*tw1*Math.pow(hw3,3)+2*(1/12*tf2*Math.pow(b2,3))+1/12*hw6*Math.pow(tw2,3);
        const Iy=2*(1/12*b2*Math.pow(tf2,3)+ag4*Math.pow(d4,2))+1/12*tw2*Math.pow(hw6,3)+2*(1/12*tf1*Math.pow(b1,3))+1/12*hw3*Math.pow(tw2,3);
        const ix=Math.sqrt(Ix/area),iy=Math.sqrt(Iy/area);
        const sx=Ix/(h1/2),sy=Iy/(h2/2);
        const zx=2*(b1*tf1)*d1+2*(tw1*hw3/2)*hw3/4+b2*b2*tf2/2+(tw2*hw6/8)*2;
        const zy=2*(b2*tf2)*d4+2*(tw2*hw6/2)*hw6/4+b1*b1*tf1/2+(tw1*hw3/8)*2;
        const J=(2*b1*Math.pow(tf1,3)+h1*Math.pow(tw1,3))/3+(2*b2*Math.pow(tf2,3)+h2*Math.pow(tw2,3))/3;
        const cw=Iy*Math.pow(h1-tf1,2)/4;

        // Compressive strength
        const lambda=Math.max(Kx*Lx/ix,Ky*Ly/iy);
        const lcfr=0.56*Math.sqrt(E/Fy),lcf=b2/(2*tf2);
        const lcwr=1.49*Math.sqrt(E/Fy),lcw=(h2-2*(tf2+r2)-tw2)/(2*tw2);
        const euler=4.71*Math.sqrt(E/Fy);
        const Fe1=Math.pow(Math.PI,2)*E/Math.pow(lambda,2);
        const G=E/(2*(1+nu));
        const Fe2=(Math.pow(Math.PI,2)*E*cw/Math.pow(Kz*Lx,2)+G*J)/(Ix+Iy);
        const Fe=Math.min(Fe1,Fe2);
        const Fcr=Math.pow(0.658,Fy/Fe)*Fy;
        const phi_Pn=0.9*area*Fcr/1000;

        // Flexural
        const lfp=0.38*Math.sqrt(E/Fy),lfr=Math.sqrt(E/Fy);
        const lf1=b1/(2*tf1),lf2=b2/(2*tf2);
        const lwp=3.76*Math.sqrt(E/Fy),lwr=5.70*Math.sqrt(E/Fy);
        const lw1=(h1-2*(tf1+r1)-tw1)/(2*tw1),lw2=(h2-2*(tf2+r2)-tw2)/(2*tw2);
        const Mpx=Math.min(Fy*zx,1.6*Fy*sx)/1e6,Mpy=Math.min(Fy*zy,1.6*Fy*sy)/1e6;
        const rtsx=Math.pow(Math.sqrt(Iy*cw)/sx,0.5),rtsy=Math.pow(Math.sqrt(Iy*cw)/sy,0.5);
        const ho1=(h1-tf1)/2,ho2=(h2-tf2)/2;
        const Lp=1.76*iy*Math.sqrt(E/Fy)/1000;
        const c=1.0;
        const Lr1=1.95*rtsx*E/(0.7*Fy)*Math.sqrt(J*c/(sx*ho1))*Math.sqrt(1+Math.sqrt(1+6.76*Math.pow(0.7*Fy*sx*ho1/(E*J*c),2)))/1000;
        const phi_Mnx=0.9*Mpx*1000,phi_Mny=0.9*Mpy*1000;

        // Shear
        const lvw=(h2-2*(tf2+r2)-tw2)/(2*tw2);
        const As1=hw3*tw1+2*tf1*b1,As2=hw6*tw2+2*tf2*b2;
        const Vny=0.6*Fy*As1/1000,Vnx=0.6*Fy*As2/1000;
        const phi_Vny=Vny,phi_Vnx=Vnx;

        const rComp=Pu/phi_Pn,rBendX=Mux/phi_Mnx,rBendY=Muy/phi_Mny;
        const rPmm=rComp>=0.2?rComp+8/9*(rBendX+rBendY):rComp/2+rBendX+rBendY;

        function fmt(n,d=2){return n.toLocaleString('en-US',{minimumFractionDigits:d,maximumFractionDigits:d});}
        function fmtI(n){return Math.round(n).toLocaleString('en-US');}

        document.addEventListener('DOMContentLoaded',function(){
            // Diagram
            const sc=144/Math.max(h1,h2,b1,b2)*0.85;
            const sH1=h1*sc,sB1=b1*sc,sTw1=Math.max(tw1*sc,2),sTf1=Math.max(tf1*sc,3);
            const sH2=h2*sc,sB2=b2*sc,sTw2=Math.max(tw2*sc,2),sTf2=Math.max(tf2*sc,3);
            const cx=84,cy=84;
            document.querySelector('.h1-web').style.cssText=`width:${sTw1}px;height:${sH1}px;left:${cx-sTw1/2}px;top:${cy-sH1/2}px;`;
            document.querySelector('.h1-flange-top').style.cssText=`width:${sB1}px;height:${sTf1}px;left:${cx-sB1/2}px;top:${cy-sH1/2}px;`;
            document.querySelector('.h1-flange-bottom').style.cssText=`width:${sB1}px;height:${sTf1}px;left:${cx-sB1/2}px;top:${cy+sH1/2-sTf1}px;`;
            document.querySelector('.h2-web').style.cssText=`width:${sH2}px;height:${sTw2}px;left:${cx-sH2/2}px;top:${cy-sTw2/2}px;`;
            document.querySelector('.h2-flange-left').style.cssText=`width:${sTf2}px;height:${sB2}px;left:${cx-sH2/2}px;top:${cy-sB2/2}px;`;
            document.querySelector('.h2-flange-right').style.cssText=`width:${sTf2}px;height:${sB2}px;left:${cx+sH2/2-sTf2}px;top:${cy-sB2/2}px;`;

            // Page 1 data
            document.getElementById('projectName1').textContent=data.name||'K-COL';
            document.getElementById('projectName2').textContent=data.name||'K-COL';
            document.getElementById('majorSection').textContent=`${h1}×${b1}×${tw1}×${tf1}`;
            document.getElementById('minorSection').textContent=`${h2}×${b2}×${tw2}×${tf2}`;
            document.getElementById('steelGrade').textContent=data.steelGrade||'SM355';
            document.getElementById('FyValue').textContent=fmtI(Fy);
            document.getElementById('EValue').textContent=fmtI(E);
            document.getElementById('nuValue').textContent=nu;
            document.getElementById('LxValue').textContent=data.Lx.toFixed(3);
            document.getElementById('LyValue').textContent=data.Ly.toFixed(3);
            document.getElementById('LbValue').textContent=data.Lb.toFixed(3);
            document.getElementById('KxValue').textContent=Kx;
            document.getElementById('KyValue').textContent=Ky;
            document.getElementById('KzValue').textContent=Kz;
            document.getElementById('CbValue').textContent=Cb;
            document.getElementById('PuValue').textContent=fmtI(Pu);
            document.getElementById('MuxValue').textContent=fmt(Mux);
            document.getElementById('MuyValue').textContent=fmt(Muy);
            document.getElementById('VuxValue').textContent=fmt(Vux);
            document.getElementById('VuyValue').textContent=fmt(Vuy);

            // Section props
            document.getElementById('p_H1').textContent=h1.toFixed(1);
            document.getElementById('p_H2').textContent=h2.toFixed(1);
            document.getElementById('p_B1').textContent=b1.toFixed(1);
            document.getElementById('p_B2').textContent=b2.toFixed(1);
            document.getElementById('p_tw1').textContent=tw1.toFixed(1);
            document.getElementById('p_tw2').textContent=tw2.toFixed(1);
            document.getElementById('p_tf1').textContent=tf1.toFixed(1);
            document.getElementById('p_tf2').textContent=tf2.toFixed(1);
            document.getElementById('p_r1').textContent=r1.toFixed(1);
            document.getElementById('p_r2').textContent=r2.toFixed(1);
            document.getElementById('p_Ag').textContent=fmt(area,1)+' mm²';
            document.getElementById('p_Ix').textContent=fmtI(Ix);
            document.getElementById('p_Iy').textContent=fmtI(Iy);
            document.getElementById('p_Zx').textContent=fmtI(zx);
            document.getElementById('p_Zy').textContent=fmtI(zy);
            document.getElementById('p_Sx').textContent=fmtI(sx);
            document.getElementById('p_Sy').textContent=fmtI(sy);
            document.getElementById('p_rx').textContent=fmt(ix,1);
            document.getElementById('p_ry').textContent=fmt(iy,1);
            document.getElementById('p_J').textContent=fmtI(J)+' mm⁴';

            // Summary
            document.getElementById('s_Pu').textContent=fmtI(Pu);
            document.getElementById('s_phiPn').textContent=fmt(phi_Pn);
            document.getElementById('s_compR').textContent=fmt(rComp,3);
            
            // Compressive 체크: ratio <= 1.0 → OK, ratio > 1.0 → NG
            const compOK = document.getElementById('s_compOK');
            if (rComp <= 1.0) {
                compOK.textContent = '→ O.K';
                compOK.className = 'green-text';
            } else {
                compOK.textContent = '→ N.G';
                compOK.className = 'red-text';
            }
            
            document.getElementById('s_Mux').textContent=fmt(Mux);
            document.getElementById('s_phiMnx').textContent=fmt(phi_Mnx);
            document.getElementById('s_bendXR').textContent=fmt(rBendX,3);
            const bendXOK = document.getElementById('s_bendXOK');
            if (bendXOK) {
                if (rBendX <= 1.0) { bendXOK.textContent = '→ O.K'; bendXOK.className = 'green-text'; }
                else { bendXOK.textContent = '→ N.G'; bendXOK.className = 'red-text'; }
            }
            document.getElementById('s_Muy').textContent=fmt(Muy);
            document.getElementById('s_phiMny').textContent=fmt(phi_Mny);
            document.getElementById('s_bendYR').textContent=fmt(rBendY,3);
            const bendYOK = document.getElementById('s_bendYOK');
            if (bendYOK) {
                if (rBendY <= 1.0) { bendYOK.textContent = '→ O.K'; bendYOK.className = 'green-text'; }
                else { bendYOK.textContent = '→ N.G'; bendYOK.className = 'red-text'; }
            }
            document.getElementById('s_pmmR1').textContent=fmt(rComp,3);
            document.getElementById('s_pmmR2').textContent=fmt(rPmm,3);
            
            // P-M-M 체크: ratio <= 1.0 → OK, ratio > 1.0 → NG
            const sPmmOK = document.getElementById('s_pmmOK');
            if (rPmm <= 1.0) {
                sPmmOK.textContent = '→ O.K';
                sPmmOK.className = 'green-text';
            } else {
                sPmmOK.textContent = '→ N.G';
                sPmmOK.className = 'red-text';
            }
            
            document.getElementById('s_Vux').textContent=fmt(Vux);
            document.getElementById('s_phiVnx').textContent=fmt(phi_Vnx);
            const rShearX = phi_Vnx > 0 ? Vux/phi_Vnx : 0;
            document.getElementById('s_shearXR').textContent=fmt(rShearX,3);
            const shearXOK = document.getElementById('s_shearXOK');
            if (shearXOK) {
                if (rShearX <= 1.0) { shearXOK.textContent = '→ O.K'; shearXOK.className = 'green-text'; }
                else { shearXOK.textContent = '→ N.G'; shearXOK.className = 'red-text'; }
            }
            document.getElementById('s_Vuy').textContent=fmt(Vuy);
            document.getElementById('s_phiVny').textContent=fmt(phi_Vny);
            const rShearY = phi_Vny > 0 ? Vuy/phi_Vny : 0;
            document.getElementById('s_shearYR').textContent=fmt(rShearY,3);
            const shearYOK = document.getElementById('s_shearYOK');
            if (shearYOK) {
                if (rShearY <= 1.0) { shearYOK.textContent = '→ O.K'; shearYOK.className = 'green-text'; }
                else { shearYOK.textContent = '→ N.G'; shearYOK.className = 'red-text'; }
            }

            // Compressive
            document.getElementById('c_KLr').textContent=fmt(lambda);
            document.getElementById('c_lcfr').textContent=fmt(lcfr);
            document.getElementById('c_lcfr2').textContent=fmt(lcfr);
            document.getElementById('c_lcf').textContent=fmt(lcf);
            document.getElementById('c_lcwr').textContent=fmt(lcwr);
            document.getElementById('c_lcwr2').textContent=fmt(lcwr);
            document.getElementById('c_lcw').textContent=fmt(lcw);
            document.getElementById('c_euler').textContent=fmt(euler);
            document.getElementById('c_euler2').textContent=fmt(euler);
            document.getElementById('c_Fe1').textContent=fmt(Fe1);
            document.getElementById('c_G').textContent=fmt(G);
            document.getElementById('c_Fe2').textContent=fmt(Fe2);
            document.getElementById('c_Fcr').textContent=fmt(Fcr);
            document.getElementById('c_phiPn').textContent=fmt(phi_Pn);
            document.getElementById('c_Pu').textContent=fmtI(Pu);

            // Page 2 - Flexural
            document.getElementById('f_lfp').textContent=fmt(lfp);
            document.getElementById('f_lfr').textContent=fmt(lfr);
            document.getElementById('f_lf1').textContent=fmt(lf1);
            document.getElementById('f_lfp2').textContent=fmt(lfp);
            
            // Plate-Thickness ratio for Flexure 체크: λff1에 따라 Compact/Non Compact/Slender
            const fLf1Compare = document.getElementById('f_lf1Compare');
            const fLf1Result = document.getElementById('f_lf1Result');
            if (lf1 <= lfp) {
                fLf1Compare.innerHTML = '&lt; λffp = <span id="f_lfp2">' + fmt(lfp) + '</span>';
                fLf1Result.textContent = '→ Compact';
                fLf1Result.className = 'calc-result green-text';
            } else if (lf1 <= lfr) {
                fLf1Compare.innerHTML = '&gt; λffp = <span id="f_lfp2">' + fmt(lfp) + '</span>';
                fLf1Result.textContent = '→ Noncompact';
                fLf1Result.className = 'calc-result red-text';
            } else {
                fLf1Compare.innerHTML = '&gt; λffr = <span id="f_lfp2">' + fmt(lfr) + '</span>';
                fLf1Result.textContent = '→ Slender';
                fLf1Result.className = 'calc-result red-text';
            }
            
            document.getElementById('f_lwp').textContent=fmt(lwp);
            document.getElementById('f_lwr').textContent=fmt(lwr);
            document.getElementById('f_lw1').textContent=fmt(lw1);
            document.getElementById('f_lwp2').textContent=fmt(lwp);
            
            // Web plate ratio for Flexure 체크: λfw1에 따라 Compact/Non Compact/Slender
            const fLw1Compare = document.getElementById('f_lw1Compare');
            const fLw1Result = document.getElementById('f_lw1Result');
            if (lw1 <= lwp) {
                fLw1Compare.innerHTML = '&lt; λfwp = <span id="f_lwp2">' + fmt(lwp) + '</span>';
                fLw1Result.textContent = '→ Compact';
                fLw1Result.className = 'calc-result green-text';
            } else if (lw1 <= lwr) {
                fLw1Compare.innerHTML = '&gt; λfwp = <span id="f_lwp2">' + fmt(lwp) + '</span>';
                fLw1Result.textContent = '→ Noncompact';
                fLw1Result.className = 'calc-result red-text';
            } else {
                fLw1Compare.innerHTML = '&gt; λfwr = <span id="f_lwp2">' + fmt(lwr) + '</span>';
                fLw1Result.textContent = '→ Slender';
                fLw1Result.className = 'calc-result red-text';
            }
            
            document.getElementById('f_Mpx').textContent=fmt(Mpx*1000);
            document.getElementById('f_rtsx').textContent=fmt(rtsx);
            document.getElementById('f_ho1').textContent=fmt(ho1,1);
            document.getElementById('f_Lp').textContent=fmt(Lp,3);
            document.getElementById('f_Lr1').textContent=fmt(Lr1);
            document.getElementById('f_Mnx').textContent=fmt(Mpx*1000);
            document.getElementById('f_phiMnx').textContent=fmt(phi_Mnx);
            document.getElementById('f_Mux').textContent=fmt(Mux);
            
            // Flexural Major Axis 체크: φbMnx > Mux이면 OK, 아니면 NG
            const fCompMnx = document.getElementById('f_compMnx');
            const fResultMnx = document.getElementById('f_resultMnx');
            if (phi_Mnx > Mux) {
                fCompMnx.innerHTML = '&gt; Mux = <span id="f_Mux">' + fmt(Mux) + '</span>';
                fResultMnx.textContent = '→ O.K';
                fResultMnx.className = 'calc-result green-text';
            } else {
                fCompMnx.innerHTML = '&lt; Mux = <span id="f_Mux">' + fmt(Mux) + '</span>';
                fResultMnx.textContent = '→ N.G';
                fResultMnx.className = 'calc-result red-text';
            }
            
            document.getElementById('f_lf2').textContent=fmt(lf2);
            document.getElementById('f_lfp3').textContent=fmt(lfp);
            
            // Plate-Thickness ratio for Flexure 체크: λff2에 따라 Compact/Non Compact/Slender
            const fLf2Compare = document.getElementById('f_lf2Compare');
            const fLf2Result = document.getElementById('f_lf2Result');
            if (lf2 <= lfp) {
                fLf2Compare.innerHTML = '&lt; λffp = <span id="f_lfp3">' + fmt(lfp) + '</span>';
                fLf2Result.textContent = '→ Compact';
                fLf2Result.className = 'calc-result green-text';
            } else if (lf2 <= lfr) {
                fLf2Compare.innerHTML = '&gt; λffp = <span id="f_lfp3">' + fmt(lfp) + '</span>';
                fLf2Result.textContent = '→ Noncompact';
                fLf2Result.className = 'calc-result red-text';
            } else {
                fLf2Compare.innerHTML = '&gt; λffr = <span id="f_lfp3">' + fmt(lfr) + '</span>';
                fLf2Result.textContent = '→ Slender';
                fLf2Result.className = 'calc-result red-text';
            }
            
            document.getElementById('f_lw2').textContent=fmt(lw2);
            document.getElementById('f_lwp3').textContent=fmt(lwp);
            
            // Web plate ratio for Flexure 체크: λfw2에 따라 Compact/Non Compact/Slender
            const fLw2Compare = document.getElementById('f_lw2Compare');
            const fLw2Result = document.getElementById('f_lw2Result');
            if (lw2 <= lwp) {
                fLw2Compare.innerHTML = '&lt; λfwp = <span id="f_lwp3">' + fmt(lwp) + '</span>';
                fLw2Result.textContent = '→ Compact';
                fLw2Result.className = 'calc-result green-text';
            } else if (lw2 <= lwr) {
                fLw2Compare.innerHTML = '&gt; λfwp = <span id="f_lwp3">' + fmt(lwp) + '</span>';
                fLw2Result.textContent = '→ Noncompact';
                fLw2Result.className = 'calc-result red-text';
            } else {
                fLw2Compare.innerHTML = '&gt; λfwr = <span id="f_lwp3">' + fmt(lwr) + '</span>';
                fLw2Result.textContent = '→ Slender';
                fLw2Result.className = 'calc-result red-text';
            }
            document.getElementById('f_Mpy').textContent=fmt(Mpy*1000);
            document.getElementById('f_phiMny').textContent=fmt(phi_Mny);
            document.getElementById('f_Muy').textContent=fmt(Muy);
            
            // Flexural Minor Axis 체크: φbMny > Muy이면 OK, 아니면 NG
            const fCompMny = document.getElementById('f_compMny');
            const fResultMny = document.getElementById('f_resultMny');
            if (phi_Mny > Muy) {
                fCompMny.innerHTML = '&gt; Muy = <span id="f_Muy">' + fmt(Muy) + '</span>';
                fResultMny.textContent = '→ O.K';
                fResultMny.className = 'calc-result green-text';
            } else {
                fCompMny.innerHTML = '&lt; Muy = <span id="f_Muy">' + fmt(Muy) + '</span>';
                fResultMny.textContent = '→ N.G';
                fResultMny.className = 'calc-result red-text';
            }

            // P-M-M
            document.getElementById('pm_r1').textContent=fmt(rComp,3);
            document.getElementById('pm_r2').textContent=fmt(rPmm,3);
            
            // P-M-M 체크: rPmm < 1.0이면 OK, 아니면 NG
            const pmResult = document.getElementById('pm_result');
            if (rPmm < 1.0) {
                pmResult.textContent = '→ O.K';
                pmResult.className = 'calc-result green-text';
            } else {
                pmResult.textContent = '→ N.G';
                pmResult.className = 'calc-result red-text';
            }

            // Shear
            document.getElementById('v_lvw').textContent=fmt(lvw);
            document.getElementById('v_lim').textContent=fmt(2.24*Math.sqrt(E/Fy));
            document.getElementById('v_As1').textContent=fmt(As1);
            document.getElementById('v_As2').textContent=fmt(As2);
            document.getElementById('v_phiVny').textContent=fmt(phi_Vny);
            document.getElementById('v_phiVnx').textContent=fmt(phi_Vnx);
            document.getElementById('v_Vuy').textContent=fmt(Vuy);
            document.getElementById('v_Vux').textContent=fmt(Vux);

            // Date
            const now=new Date();
            const dateStr=now.toISOString().slice(0,10)+' '+now.toTimeString().slice(0,5);
            document.getElementById('printDate1').textContent=dateStr;
            document.getElementById('printDate2').textContent=dateStr;
        });
    </script>
    <script src="../../js/auth-config.js"></script>
    <script src="../../js/auth.js"></script>
    <!-- Auth-guard removed - print page is public -->
</body>
</html>
