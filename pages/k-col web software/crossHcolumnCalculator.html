<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>SRC(Cross H) Design Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100dvh;
            padding: 5px;
        }

        .calculator-wrapper {
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        /* Ìó§Îçî */
        .header {
            background: linear-gradient(135deg, #1e3a5f, #2d5a87);
            color: white;
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            font-size: 13px;
            padding: 6px 12px;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 4px;
            transition: all 0.2s;
        }

        .header a:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 500;
        }

        .header-right {
            display: flex;
            gap: 8px;
        }

        .type-btn {
            padding: 8px 20px;
            border: 2px solid rgba(255,255,255,0.5);
            background: transparent;
            color: white;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .type-btn.active, .type-btn:hover {
            background: white;
            color: #1e3a5f;
            border-color: white;
        }

        /* Î©îÏù∏ Ïª®ÌÖêÏ∏† */
        .main-content {
            display: grid;
            grid-template-columns: 500px 1fr;
            gap: 0;
        }

        /* Ï¢åÏ∏°: Îã®Î©¥ÎèÑ + ÏπòÏàò */
        .left-section {
            background: #f8fafc;
            padding: 20px 20px 0 20px;
            border-right: 1px solid #e2e8f0;
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #1e3a5f;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 16px;
            background: #667eea;
            border-radius: 2px;
        }

        .diagram-container {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
            position: relative;
        }

        .section-image {
            max-width: 100%;
            height: auto;
            max-height: 200px;
            display: block;
            margin: 0 auto;
        }

        .diagram-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
            font-size: 11px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-box {
            width: 12px;
            height: 12px;
            border: 1px solid #666;
            border-radius: 2px;
            flex-shrink: 0;
        }

        .legend-major {
            background: #22c55e;
        }

        .legend-minor {
            background: #3b82f6;
        }

        .copy-btn {
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            margin-bottom: 15px;
            transition: transform 0.2s;
        }

        .copy-btn:hover {
            transform: translateY(-1px);
        }

        .quick-calc-btn {
            width: 100%;
            padding: 8px 14px;
            margin-top: 15px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .quick-calc-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5);
        }

        .quick-calc-btn:active {
            transform: translateY(0);
        }

        .dimensions-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .dim-box {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
        }

        .dim-box h4 {
            font-size: 12px;
            color: #667eea;
            margin-bottom: 10px;
            text-align: center;
            font-weight: 600;
        }

        .dim-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            font-size: 11px;
        }

        .dim-row label {
            color: #666;
            font-weight: 500;
        }

        .dim-row input {
            width: 45px;
            padding: 4px 6px;
            border: 1px solid #ddd;
            border-radius: 3px;
            text-align: right;
            font-size: 11px;
        }

        .dim-row input:focus {
            outline: none;
            border-color: #667eea;
        }

        .dim-row select {
            width: 100px;
            padding: 4px 6px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 11px;
            background: white;
            cursor: pointer;
        }

        .dim-row select:focus {
            outline: none;
            border-color: #667eea;
        }

        .dim-row .unit {
            font-size: 10px;
            color: #999;
            width: 20px;
        }

        /* Ïö∞Ï∏°: ÌååÎùºÎØ∏ÌÑ∞ Í∑∏Î¶¨Îìú */
        .right-section {
            padding: 20px;
        }

        .params-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .param-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 8px;
        }

        .param-card.full-width {
            grid-column: 1 / -1;
        }

        .param-title {
            font-size: 12px;
            font-weight: 600;
            color: #1e3a5f;
            margin-bottom: 6px;
            padding-bottom: 4px;
            border-bottom: 2px solid #667eea;
        }

        .param-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .param-row label {
            font-size: 12px;
            color: #555;
        }

        .param-row .input-group {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .param-row input {
            width: 80px;
            padding: 4px 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: right;
            font-size: 11px;
        }

        .param-row input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .param-row select {
            padding: 4px 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 11px;
            background: white;
        }

        .param-row .unit {
            font-size: 11px;
            color: #888;
            min-width: 35px;
        }

        .param-grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .param-grid-3 .item {
            text-align: center;
        }

        .param-grid-3 label {
            display: block;
            font-size: 11px;
            color: #666;
            margin-bottom: 4px;
        }

        .param-grid-3 input {
            width: 100%;
            padding: 4px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 11px;
        }

        .load-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .load-grid .param-row {
            margin-bottom: 0;
        }

        .load-grid input {
            width: 60px;
        }

        /* ÌïòÎã® Ïï°ÏÖò */
        .action-bar {
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
            padding: 10px 0 0 0;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
            margin-bottom: 0;
            width: 100%;
        }

        .action-btn {
            width: 100%;
            padding: 14px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            white-space: normal;
            line-height: 1.4;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            transition: all 0.2s;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-btn.primary {
            background: #6b7280;
            color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .action-btn.primary:hover {
            background: #4b5563;
            transform: translateY(-1px);
        }

        .action-btn.secondary {
            background: #9ca3af;
            color: white;
            border: none;
        }

        .action-btn.secondary:hover {
            background: #6b7280;
        }

        #rolled-cross-h-btn {
            background: #3b82f6 !important;
        }

        #rolled-cross-h-btn:hover {
            background: #2563eb !important;
        }

        .beam-type-btns {
            display: contents;
        }

        .beam-type-btn {
            width: 100%;
            padding: 12px;
            background: #1e3a5f;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            transition: background 0.2s;
            box-sizing: border-box;
        }

        .beam-type-btn:hover {
            background: #2d5a87;
        }

        #auto-find-section-btn {
            background: #38a169 !important;
        }

        #auto-find-section-btn:hover {
            background: #2f855a !important;
        }

        /* Ìï¥ÏÑù Í≤∞Í≥º Î∞ïÏä§ (Ïö∞Ï∏° ÏÑπÏÖò ÎÇ¥Î∂Ä) */
        .results-box {
            background: linear-gradient(135deg, #f0f4ff, #e8f4f8);
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .results-box .param-title {
            border-bottom-color: #667eea;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .result-item {
            background: white;
            border-radius: 6px;
            padding: 10px;
            border: 1px solid #e2e8f0;
        }

        .result-name {
            font-size: 11px;
            font-weight: 600;
            color: #1e3a5f;
            margin-bottom: 5px;
        }

        .result-check {
            font-size: 10px;
            color: #555;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .result-val {
            font-weight: 600;
            color: #333;
        }

        .result-status {
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 9px;
            font-weight: 500;
            margin-left: auto;
        }

        .result-status.pending {
            background: #fef3c7;
            color: #92400e;
        }

        .result-status.ok {
            background: #d1fae5;
            color: #065f46;
        }

        .result-status.ng {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Multi Column Calculation Sheet */
        .multi-column-sheet {
            background: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            margin-top: 12px;
            flex-shrink: 0;
        }

        .multi-column-table-container {
            overflow-x: auto;
            overflow-y: visible;
            margin-top: 8px;
            width: 100%;
        }

        .multi-column-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            min-width: 500px;
            table-layout: fixed;
        }

        .multi-column-table thead {
            background: #f8fafc;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .multi-column-table th {
            padding: 8px 6px;
            text-align: center;
            font-weight: 600;
            color: #1e3a5f;
            border: 1px solid #e2e8f0;
            background: #f8fafc;
            font-size: 11px;
            width: 18%;
        }
        
        .multi-column-table th:first-child {
            width: 10%;
        }

        .multi-column-table td {
            padding: 6px;
            text-align: center;
            border: 1px solid #e2e8f0;
            width: 18%;
        }
        
        .multi-column-table td:first-child {
            width: 10%;
        }

        .multi-column-table tbody tr:hover {
            background: #f8fafc;
        }

        .multi-column-table input {
            width: 100%;
            padding: 4px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 11px;
        }

        .multi-column-table input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }

        .multi-column-table .column-number {
            font-weight: 600;
            color: #1e3a5f;
            background: #f8fafc;
        }

        .multi-column-table .result-cell {
            font-weight: 500;
            color: #555;
        }

        /* Multi Column Execution Bar */
        .multi-column-execution-bar {
            display: flex;
            justify-content: center;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #e2e8f0;
        }

        .multi-column-execution-btn {
            width: 100%;
            max-width: 400px;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .multi-column-execution-btn:hover {
            background: linear-gradient(135deg, #5568d3, #6b3fa0);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .multi-column-execution-btn:active {
            transform: translateY(0);
        }

        /* NAME ÏûÖÎ†• */
        .name-input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            align-items: center;
        }

        .name-input-row label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .name-input-row input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="calculator-wrapper">
        <!-- Ìó§Îçî -->
        <div class="header">
            <div class="header-left">
                <a href="../../index.html">‚Üê ÌôàÏúºÎ°ú</a>
                <h1>SRC(Cross H) Design Calculator</h1>
            </div>
            <div class="header-right">
                <button class="type-btn active" data-type="kcol">Rolled H</button>
                <button class="type-btn" data-type="posh">Pos-H / Built-UP H</button>
            </div>
        </div>
            
        <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† -->
        <div class="main-content">
            <!-- Ï¢åÏ∏°: Îã®Î©¥ÎèÑ + ÏπòÏàò -->
            <div class="left-section">
                <div class="section-title">Section Dimensions</div>
                
                <div class="name-input-row">
                    <label>NAME</label>
                    <input type="text" value="K-COL" id="projectName">
                </div>
                
                <div class="diagram-container">
                    <img src="../../assets/images/2H-section.png" alt="Cross H Column Îã®Î©¥ÎèÑ" class="section-image">
                    <div class="diagram-legend">
                        <div class="legend-item">
                            <div class="legend-box legend-major"></div>
                            <span>Major (H1)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-box legend-minor"></div>
                            <span>Minor (H2)</span>
                        </div>
                    </div>
                </div>
                
                <button class="copy-btn" onclick="copyMajorToMinor()">
                    Major ‚Üî Minor Îã®Î©¥ ÎèôÏùº Ï†ÅÏö©
                </button>
                
                <div class="dimensions-container">
                    <div class="dim-box">
                        <h4>Major (H1)</h4>
                        <div class="dim-row">
                            <label>H1</label>
                            <div id="H1Container">
                                <select id="H1">
                                    <option value="400">H400x200</option>
                                    <option value="450">H450x200</option>
                                    <option value="500" selected>H500x200</option>
                                    <option value="506">H506x201</option>
                                    <option value="600">H600x200</option>
                                    <option value="606">H606x201</option>
                                    <option value="582">H582x300</option>
                                    <option value="588">H588x300</option>
                                    <option value="692">H692x300</option>
                                    <option value="700">H700x300</option>
                                    <option value="800">H800x300</option>
                                    <option value="900">H900x300</option>
                                    <option value="912">H912x302</option>
                                </select>
                            </div>
                            <span class="unit">mm</span>
                        </div>
                        <div class="dim-row">
                            <label>B1</label>
                            <input type="text" value="200" id="B1">
                            <span class="unit">mm</span>
                        </div>
                        <div class="dim-row">
                            <label>tw1</label>
                            <input type="text" value="8" id="tw1">
                            <span class="unit">mm</span>
                        </div>
                        <div class="dim-row">
                            <label>tf1</label>
                            <input type="text" value="13" id="tf1">
                            <span class="unit">mm</span>
                        </div>
                        <div class="dim-row">
                            <label>r1</label>
                            <input type="text" value="18" id="r1">
                            <span class="unit">mm</span>
                        </div>
                    </div>
                    
                    <div class="dim-box">
                        <h4>Minor (H2)</h4>
                        <div class="dim-row">
                            <label>H2</label>
                            <div id="H2Container">
                                <select id="H2">
                                    <option value="400">H400x200</option>
                                    <option value="450" selected>H450x200</option>
                                    <option value="500">H500x200</option>
                                    <option value="506">H506x201</option>
                                    <option value="600">H600x200</option>
                                    <option value="606">H606x201</option>
                                    <option value="582">H582x300</option>
                                    <option value="588">H588x300</option>
                                    <option value="692">H692x300</option>
                                    <option value="700">H700x300</option>
                                    <option value="800">H800x300</option>
                                    <option value="900">H900x300</option>
                                    <option value="912">H912x302</option>
                                </select>
                            </div>
                            <span class="unit">mm</span>
                        </div>
                        <div class="dim-row">
                            <label>B2</label>
                            <input type="text" value="200" id="B2">
                            <span class="unit">mm</span>
                        </div>
                        <div class="dim-row">
                            <label>tw2</label>
                            <input type="text" value="9" id="tw2">
                            <span class="unit">mm</span>
                        </div>
                        <div class="dim-row">
                            <label>tf2</label>
                            <input type="text" value="14" id="tf2">
                            <span class="unit">mm</span>
                        </div>
                        <div class="dim-row">
                            <label>r2</label>
                            <input type="text" value="18" id="r2">
                            <span class="unit">mm</span>
                    </div>
                </div>
            </div>
            
                <!-- Îã®Î©¥Ï†Å As ÌëúÌòÑ -->
                <div id="section-area-display" style="margin-bottom: 8px; font-size: 14px; color: #4a5568; text-align: center;">Îã®Î©¥Ï†Å :  mm¬≤  |  Îã®Ï§ë :  kg/m</div>
                
                <!-- Í∞ÑÌé∏ Í≥ÑÏÇ∞ Î≤ÑÌäº -->
                <button class="quick-calc-btn" onclick="quickCalculate()">
                    ‚ö° Í∞ÑÌé∏Í≥ÑÏÇ∞(1-Column)
                </button>
                
                <!-- ÌïòÎã® Ïï°ÏÖò Î∞î -->
                <div class="action-bar">
                    <a href="Cross-H-Column-Calculation-Data1.html" class="action-btn primary" onclick="saveInputData(); return true;">
                        üìÑ Í≥ÑÏÇ∞ÏÑú(1-Column)
                    </a>
                    <div class="beam-type-btns">
                        <button class="beam-type-btn" id="auto-find-section-btn" onclick="window.location.href='auto-find-section.html'">Auto Find Section<br>RH / Built-Up<br>(Included BOQ)</button>
                        <button class="beam-type-btn">SRC(Cross H)</button>
                    </div>
                    <button class="action-btn secondary" id="rolled-cross-h-btn" onclick="openColumnPlanInput();">
                        Í∏∞Îë•ÌèâÎ©¥ÎèÑ /<br>Í∏∞Îë•Î≤àÌò∏ ÏûÖÎ†•
                    </button>
                        </div>
                    </div>
                    
            <!-- Ïö∞Ï∏°: ÌååÎùºÎØ∏ÌÑ∞ -->
            <div class="right-section">
                <div class="params-grid">
                    <!-- Steel Material -->
                    <div class="param-card">
                        <div class="param-title">Steel Material</div>
                        <div class="param-row">
                            <label>Grade</label>
                            <select id="steelGrade">
                                <option>SS275</option>
                                <option>SS355</option>
                                <option selected>SM355</option>
                                <option>SM420</option>
                            </select>
                        </div>
                        <div class="param-row">
                            <label>Fy</label>
                            <div class="input-group">
                                <input type="text" value="355" id="Fy">
                            <span class="unit">MPa</span>
                        </div>
                    </div>
                        <div class="param-row">
                            <label>E</label>
                            <div class="input-group">
                                <input type="text" value="210,000" id="E">
                            <span class="unit">MPa</span>
                            </div>
                        </div>
                        <div class="param-row">
                            <label>ŒΩ</label>
                            <div class="input-group">
                                <input type="text" value="0.3" id="nu">
                                <span class="unit"></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Effective Length Factor -->
                    <div class="param-card">
                        <div class="param-title">Effective Length Factor</div>
                        <div class="param-grid-3">
                            <div class="item">
                                <label>Kx</label>
                                <input type="text" value="0.8" id="Kx">
                        </div>
                            <div class="item">
                                <label>Ky</label>
                                <input type="text" value="0.8" id="Ky">
                            </div>
                            <div class="item">
                                <label>Kz</label>
                                <input type="text" value="0.8" id="Kz">
                            </div>
                        </div>
                        <div class="param-row" style="margin-top: 12px; justify-content: space-between;">
                            <label style="flex: 1; white-space: nowrap;">Cb (Lateral Buckling)</label>
                            <div class="input-group" style="margin-left: auto;">
                                <input type="text" value="1" id="Cb" style="width: 50px; text-align: center;">
                    </div>
                </div>
            </div>
            
                    <!-- Unbraced Length -->
                    <div class="param-card">
                        <div class="param-title">Unbraced Length</div>
                        <div class="param-row">
                            <label>Lx</label>
                            <div class="input-group">
                                <input type="text" value="4.5" id="Lx">
                                <span class="unit">m</span>
                            </div>
                        </div>
                        <div class="param-row">
                            <label>Ly</label>
                            <div class="input-group">
                                <input type="text" value="4.5" id="Ly">
                                <span class="unit">m</span>
                            </div>
                        </div>
                        <div class="param-row">
                            <label>Lb</label>
                            <div class="input-group">
                                <input type="text" value="4.5" id="Lb">
                                <span class="unit">m</span>
                    </div>
                </div>
            </div>
            
                    <!-- Design Load -->
                    <div class="param-card">
                        <div class="param-title">Design Load</div>
                        <div class="param-row">
                            <label>Pu (Axial)</label>
                            <div class="input-group">
                                <input type="text" value="7,561" id="Pu">
                                <span class="unit">kN</span>
                        </div>
                        </div>
                        <div class="load-grid" style="margin-top: 8px;">
                            <div class="param-row">
                                <label>Mux</label>
                                <div class="input-group">
                                    <input type="text" value="0" id="Mux">
                                    <span class="unit">kN¬∑m</span>
                        </div>
                    </div>
                            <div class="param-row">
                                <label>Muy</label>
                                <div class="input-group">
                                    <input type="text" value="0" id="Muy">
                                    <span class="unit">kN¬∑m</span>
                </div>
            </div>
                            <div class="param-row">
                                <label>Vux</label>
                                <div class="input-group">
                                    <input type="text" value="0" id="Vux">
                                    <span class="unit">kN</span>
                        </div>
                    </div>
                            <div class="param-row">
                                <label>Vuy</label>
                                <div class="input-group">
                                    <input type="text" value="0" id="Vuy">
                                <span class="unit">kN</span>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                    
                <!-- Ìï¥ÏÑù Í≤∞Í≥º (Ïö∞Ï∏° ÏÑπÏÖò ÎÇ¥Î∂Ä) -->
                <div class="results-box">
                    <div class="param-title">üìä 1-Column Calculation Results</div>
                    <div class="results-grid">
                        <div class="result-item">
                            <div class="result-name">Compressive</div>
                            <div class="result-check">
                                <span>Pu/œÜPn = </span>
                                <span class="result-val">-</span>
                                <span class="result-status pending">ÎåÄÍ∏∞</span>
                            </div>
                        </div>
                        <div class="result-item">
                            <div class="result-name">Bending X</div>
                            <div class="result-check">
                                <span>Mux/œÜMnx = </span>
                                <span class="result-val">-</span>
                                <span class="result-status pending">ÎåÄÍ∏∞</span>
                            </div>
                        </div>
                        <div class="result-item">
                            <div class="result-name">Bending Y</div>
                            <div class="result-check">
                                <span>Muy/œÜMny = </span>
                                <span class="result-val">-</span>
                                <span class="result-status pending">ÎåÄÍ∏∞</span>
                            </div>
                        </div>
                        <div class="result-item">
                            <div class="result-name">P-M-M</div>
                            <div class="result-check">
                                <span>Combined = </span>
                                <span class="result-val">-</span>
                                <span class="result-status pending">ÎåÄÍ∏∞</span>
                            </div>
                        </div>
                        <div class="result-item">
                            <div class="result-name">Shear X</div>
                            <div class="result-check">
                                <span>Vux/œÜVnx = </span>
                                <span class="result-val">-</span>
                                <span class="result-status pending">ÎåÄÍ∏∞</span>
                    </div>
                </div>
                        <div class="result-item">
                            <div class="result-name">Shear Y</div>
                            <div class="result-check">
                                <span>Vuy/œÜVny = </span>
                                <span class="result-val">-</span>
                                <span class="result-status pending">ÎåÄÍ∏∞</span>
            </div>
        </div>
                    </div>
        </div>
        
                <!-- Multi Column Calculation Sheet -->
                <div class="multi-column-sheet">
                    <div class="param-title">üìã Multi Column Calculation Sheet</div>
                    <div class="multi-column-table-container">
                        <table class="multi-column-table">
                            <thead>
                                <tr>
                                    <th>Col. no</th>
                                    <th>Pu</th>
                                    <th>Mux</th>
                                    <th>Muy</th>
                                    <th>Compressive</th>
                                    <th>P-M-M</th>
                                </tr>
                            </thead>
                            <tbody id="multiColumnTableBody">
                                <!-- JavaScriptÎ°ú ÎèôÏ†Å ÏÉùÏÑ± (6Í∞ú Í∏∞Îë•) -->
                            </tbody>
                        </table>
        </div>
                    <div class="multi-column-execution-bar">
                        <button class="multi-column-execution-btn" onclick="executeMultiColumnCalculation()">
                            ‚ö° Multi Column Execution
                        </button>
    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function copyMajorToMinor() {
            document.getElementById('H2').value = document.getElementById('H1').value;
            document.getElementById('B2').value = document.getElementById('B1').value;
            document.getElementById('tw2').value = document.getElementById('tw1').value;
            document.getElementById('tf2').value = document.getElementById('tf1').value;
            document.getElementById('r2').value = document.getElementById('r1').value;
        }

        // Ï†ÑÏ≤¥ Í≥ÑÏÇ∞ÏÑú Î≥¥Í∏∞ ÌÅ¥Î¶≠ Ïãú ÏûÖÎ†• Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
        function saveInputData() {
            const inputData = {
                // Section Dimensions
                H1: parseFloat(document.getElementById('H1').value),
                B1: parseFloat(document.getElementById('B1').value),
                tw1: parseFloat(document.getElementById('tw1').value),
                tf1: parseFloat(document.getElementById('tf1').value),
                r1: parseFloat(document.getElementById('r1').value),
                H2: parseFloat(document.getElementById('H2').value),
                B2: parseFloat(document.getElementById('B2').value),
                tw2: parseFloat(document.getElementById('tw2').value),
                tf2: parseFloat(document.getElementById('tf2').value),
                r2: parseFloat(document.getElementById('r2').value),
                // Material
                steelGrade: document.getElementById('steelGrade').value,
                Fy: parseFloat(document.getElementById('Fy').value.replace(/,/g, '')),
                E: parseFloat(document.getElementById('E').value.replace(/,/g, '')),
                nu: parseFloat(document.getElementById('nu').value),
                // Unbraced Length
                Lx: parseFloat(document.getElementById('Lx').value),
                Ly: parseFloat(document.getElementById('Ly').value),
                Lb: parseFloat(document.getElementById('Lb').value),
                // Effective Length Factor
                Kx: parseFloat(document.getElementById('Kx').value),
                Ky: parseFloat(document.getElementById('Ky').value),
                Kz: parseFloat(document.getElementById('Kz').value),
                // Cb
                Cb: parseFloat(document.getElementById('Cb').value),
                // Design Load
                Pu: parseFloat(document.getElementById('Pu').value.replace(/,/g, '')),
                Mux: parseFloat(document.getElementById('Mux').value),
                Muy: parseFloat(document.getElementById('Muy').value),
                Vux: parseFloat(document.getElementById('Vux').value),
                Vuy: parseFloat(document.getElementById('Vuy').value),
                // Name
                name: document.getElementById('projectName') ? document.getElementById('projectName').value : 'K-COL'
            };
            localStorage.setItem('kcolInputData', JSON.stringify(inputData));
        }

        // Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú ÌôïÏù∏
        function checkLoginStatus() {
            const loginData = JSON.parse(localStorage.getItem('kcolLoginData')) || null;
            if (loginData && loginData.isLoggedIn) {
                // Î°úÍ∑∏Ïù∏ ÎßåÎ£å ÏãúÍ∞Ñ ÌôïÏù∏ (24ÏãúÍ∞Ñ)
                const now = new Date().getTime();
                if (now - loginData.loginTime < 24 * 60 * 60 * 1000) {
                    return true;
                } else {
                    // ÎßåÎ£åÎêú Í≤ΩÏö∞ Î°úÍ∑∏Ïù∏ Ï†ïÎ≥¥ Ï†úÍ±∞
                    localStorage.removeItem('kcolLoginData');
                }
            }
            return false;
        }

        // Î°úÍ∑∏Ïù∏ Î™®Îã¨ ÌëúÏãú
        function showLoginModal() {
            const modal = document.getElementById('loginModal');
            if (modal) {
                modal.style.display = 'flex';
                document.getElementById('loginUserId').focus();
            }
        }

        // Î°úÍ∑∏Ïù∏ Î™®Îã¨ Îã´Í∏∞
        function closeLoginModal() {
            const modal = document.getElementById('loginModal');
            if (modal) {
                modal.style.display = 'none';
                document.getElementById('loginUserId').value = '';
                document.getElementById('loginPassword').value = '';
                document.getElementById('loginError').textContent = '';
            }
        }

        // Î°úÍ∑∏Ïù∏ Ï≤òÎ¶¨
        function handleLogin() {
            const userId = document.getElementById('loginUserId').value.trim();
            const password = document.getElementById('loginPassword').value;

            if (!userId || !password) {
                document.getElementById('loginError').textContent = 'IDÏôÄ ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.';
                return;
            }

            // Í∞ÑÎã®Ìïú Ïù∏Ï¶ù (Ïã§Ï†úÎ°úÎäî ÏÑúÎ≤Ñ API Ìò∏Ï∂ú ÌïÑÏöî)
            const loginData = {
                isLoggedIn: true,
                userId: userId,
                loginTime: new Date().getTime()
            };
            localStorage.setItem('kcolLoginData', JSON.stringify(loginData));

            closeLoginModal();
            // Î°úÍ∑∏Ïù∏ ÌõÑ PDF Ï∂úÎ†• Í≥ÑÏÜç ÏßÑÌñâ
            proceedWithPrintCalculationSheet();
        }

        // PDF Ï∂úÎ†• ÏßÑÌñâ (Î°úÍ∑∏Ïù∏ ÌõÑ)
        function proceedWithPrintCalculationSheet() {
            // Î®ºÏ†Ä ÏûÖÎ†• Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            saveInputData();
            
            // Í≥ÑÏÇ∞ÏÑú ÌÜµÌï© Ïù∏ÏáÑ ÌéòÏù¥ÏßÄÎ•º ÏÉà Ï∞ΩÏóêÏÑú Ïó¥Í≥† Ïù∏ÏáÑ
            const printWindow = window.open('Cross-H-Column-Print.html', '_blank');
            
            // ÌéòÏù¥ÏßÄ Î°úÎìú ÏôÑÎ£å ÌõÑ Ïù∏ÏáÑ ÎåÄÌôîÏÉÅÏûê ÌëúÏãú
            if (printWindow) {
                printWindow.onload = function() {
                    setTimeout(function() {
                        printWindow.print();
                    }, 800);
                };
            }
        }

        // Rolled Cross H Auto Find Section Ïã§Ìñâ
        function printCalculationSheet() {
            // Built-UP Î™®ÎìúÏù∏ÏßÄ ÌôïÏù∏
            if (isPosModeActive()) {
                alert('Rolled Cross H Auto Find SectionÏùÄ Built-UP Î™®ÎìúÏóêÏÑú ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.\n\nRolled H Î™®ÎìúÎ•º ÏÑ†ÌÉùÌïú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            // Rolled H Î™®ÎìúÏù∏ Í≤ΩÏö∞ Auto Find Section ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
            window.location.href = 'auto-find-section.html';
        }

        // Í∏∞Îë•ÌèâÎ©¥ÎèÑ / Í∏∞Îë•Î≤àÌò∏ ÏûÖÎ†• Î™®Îã¨ Ïó¥Í∏∞
        function openColumnPlanInput() {
            // Î™®Îã¨Ïù¥ Ïù¥ÎØ∏ Ï°¥Ïû¨ÌïòÎäîÏßÄ ÌôïÏù∏
            let modal = document.getElementById('columnPlanInputModal');
            if (!modal) {
                // Î™®Îã¨ HTML ÏÉùÏÑ±
                const modalHTML = `
                    <div id="columnPlanInputModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; overflow-y: auto;">
                        <div style="position: relative; max-width: 900px; margin: 50px auto; background: white; border-radius: 12px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); padding: 30px;">
                            <button onclick="closeColumnPlanInput()" style="position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 24px; color: #999; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">&times;</button>
                            <h2 style="margin-bottom: 20px; color: #1e3a5f; font-size: 24px; text-align: center;">Í∏∞Îë•ÌèâÎ©¥ÎèÑ / Í∏∞Îë•Î≤àÌò∏ ÏûÖÎ†•</h2>
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 600;">Í∏∞Îë•ÌèâÎ©¥ÎèÑ</label>
                                <div style="border: 2px dashed #cbd5e0; border-radius: 8px; padding: 20px; text-align: center; background: #f7fafc;">
                                    <input type="file" id="columnPlanFile" accept="image/*" style="display: none;" onchange="handleColumnPlanFile(this)">
                                    <button onclick="document.getElementById('columnPlanFile').click()" style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 14px;">Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú</button>
                                    <p id="columnPlanFileName" style="margin-top: 10px; color: #718096; font-size: 12px;"></p>
                                    <div id="columnPlanPreview" style="margin-top: 15px; display: none;">
                                        <img id="columnPlanImage" src="" alt="Í∏∞Îë•ÌèâÎ©¥ÎèÑ ÎØ∏Î¶¨Î≥¥Í∏∞" style="max-width: 100%; max-height: 400px; border-radius: 4px;">
                                    </div>
                                </div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 600;">Í∏∞Îë•Î≤àÌò∏ ÏûÖÎ†•</label>
                                <textarea id="columnNumbers" rows="10" placeholder="Í∏∞Îë•Î≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: KC1, KC2, KC3... ÎòêÎäî Ìïú Ï§ÑÏóê ÌïòÎÇòÏî©)" style="width: 100%; padding: 12px; border: 1px solid #cbd5e0; border-radius: 6px; font-size: 14px; font-family: inherit; resize: vertical;"></textarea>
                            </div>
                            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 30px;">
                                <button onclick="saveColumnPlanInput()" style="background: #667eea; color: white; border: none; padding: 12px 30px; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: 600;">Ï†ÄÏû•</button>
                                <button onclick="closeColumnPlanInput()" style="background: #e2e8f0; color: #4a5568; border: none; padding: 12px 30px; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: 600;">Ï∑®ÏÜå</button>
                            </div>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', modalHTML);
                modal = document.getElementById('columnPlanInputModal');
            }
            modal.style.display = 'block';
        }

        // Í∏∞Îë•ÌèâÎ©¥ÎèÑ ÌååÏùº Ï≤òÎ¶¨
        function handleColumnPlanFile(input) {
            const file = input.files[0];
            if (file) {
                document.getElementById('columnPlanFileName').textContent = file.name;
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('columnPlanPreview');
                    const img = document.getElementById('columnPlanImage');
                    img.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        }

        // Í∏∞Îë•ÌèâÎ©¥ÎèÑ ÏûÖÎ†• Ï†ÄÏû•
        function saveColumnPlanInput() {
            const columnNumbers = document.getElementById('columnNumbers').value.trim();
            const fileInput = document.getElementById('columnPlanFile');
            const file = fileInput.files[0];
            
            const data = {
                columnNumbers: columnNumbers,
                fileName: file ? file.name : null,
                timestamp: new Date().toISOString()
            };
            
            // ÌååÏùºÏù¥ ÏûàÏúºÎ©¥ base64Î°ú Ï†ÄÏû•
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    data.imageData = e.target.result;
                    localStorage.setItem('columnPlanInputData', JSON.stringify(data));
                    alert('Í∏∞Îë•ÌèâÎ©¥ÎèÑ Î∞è Í∏∞Îë•Î≤àÌò∏Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
                    closeColumnPlanInput();
                };
                reader.readAsDataURL(file);
            } else {
                localStorage.setItem('columnPlanInputData', JSON.stringify(data));
                alert('Í∏∞Îë•Î≤àÌò∏Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
                closeColumnPlanInput();
            }
        }

        // Í∏∞Îë•ÌèâÎ©¥ÎèÑ ÏûÖÎ†• Î™®Îã¨ Îã´Í∏∞
        function closeColumnPlanInput() {
            const modal = document.getElementById('columnPlanInputModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // H1/H2 ÌïÑÎìú Î™®Îìú Ï†ÑÌôò Ìï®Ïàò (select ‚Üî input)
        function switchToInputMode() {
            const h1Container = document.getElementById('H1Container');
            const h2Container = document.getElementById('H2Container');
            const h1Value = document.getElementById('H1').value;
            const h2Value = document.getElementById('H2').value;
            
            // H1ÏùÑ inputÏúºÎ°ú Î≥ÄÍ≤Ω
            h1Container.innerHTML = '<input type="text" id="H1" value="' + h1Value + '" style="width: 100px;">';
            document.getElementById('H1').addEventListener('change', function() {
                updateCrossSection();
            });
            
            // H2Î•º inputÏúºÎ°ú Î≥ÄÍ≤Ω
            h2Container.innerHTML = '<input type="text" id="H2" value="' + h2Value + '" style="width: 100px;">';
            document.getElementById('H2').addEventListener('change', function() {
                updateCrossSection();
            });
        }

        function switchToSelectMode() {
            const h1Container = document.getElementById('H1Container');
            const h2Container = document.getElementById('H2Container');
            
            // H1ÏùÑ selectÎ°ú Î≥ÄÍ≤Ω
            h1Container.innerHTML = `
                <select id="H1">
                    <option value="400">H400x200</option>
                    <option value="450">H450x200</option>
                    <option value="500" selected>H500x200</option>
                    <option value="506">H506x201</option>
                    <option value="600">H600x200</option>
                    <option value="606">H606x201</option>
                    <option value="582">H582x300</option>
                    <option value="588">H588x300</option>
                    <option value="692">H692x300</option>
                    <option value="700">H700x300</option>
                    <option value="800">H800x300</option>
                    <option value="900">H900x300</option>
                    <option value="912">H912x302</option>
                </select>`;
            document.getElementById('H1').addEventListener('change', updateH1Dimensions);
            
            // H2Î•º selectÎ°ú Î≥ÄÍ≤Ω
            h2Container.innerHTML = `
                <select id="H2">
                    <option value="400">H400x200</option>
                    <option value="450" selected>H450x200</option>
                    <option value="500">H500x200</option>
                    <option value="506">H506x201</option>
                    <option value="600">H600x200</option>
                    <option value="606">H606x201</option>
                    <option value="582">H582x300</option>
                    <option value="588">H588x300</option>
                    <option value="692">H692x300</option>
                    <option value="700">H700x300</option>
                    <option value="800">H800x300</option>
                    <option value="900">H900x300</option>
                    <option value="912">H912x302</option>
                </select>`;
            document.getElementById('H2').addEventListener('change', updateH2Dimensions);
            
            // KS ÌëúÏ§ÄÍ∞íÏúºÎ°ú ÏóÖÎç∞Ïù¥Ìä∏
            updateH1Dimensions();
            updateH2Dimensions();
        }

        // Type button toggle (Rolled H vs Pos-H / Built-UP H)
        document.querySelectorAll('.type-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Pos-H / Built-UP H ÏÑ†ÌÉù Ïãú: ÏßÅÏ†ë ÏûÖÎ†• Î™®Îìú, r1/r2=0
                if (this.dataset.type === 'posh') {
                    switchToInputMode();
                    document.getElementById('r1').value = 0;
                    document.getElementById('r2').value = 0;
                    updateCrossSection();
                } 
                // Rolled H ÏÑ†ÌÉù Ïãú: ÎìúÎ°≠Îã§Ïö¥ Î™®Îìú, KS ÌëúÏ§ÄÍ∞í
                else if (this.dataset.type === 'kcol') {
                    switchToSelectMode();
                }
            });
        });

        // Beam type button toggle
        document.querySelectorAll('.beam-type-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // auto-find-section-btnÏùÄ Ï†úÏô∏ÌïòÍ≥† Î∞∞Í≤ΩÏÉâ Î≥ÄÍ≤Ω
                document.querySelectorAll('.beam-type-btn').forEach(b => {
                    if (b.id !== 'auto-find-section-btn') {
                        b.style.background = '#1e3a5f';
                    }
                });
                // auto-find-section-btnÏù¥ ÏïÑÎãå Í≤ΩÏö∞ÏóêÎßå Î∞∞Í≤ΩÏÉâ Î≥ÄÍ≤Ω
                if (this.id !== 'auto-find-section-btn') {
                    this.style.background = 'linear-gradient(135deg, #667eea, #764ba2)';
                }
            });
        });

        // ===== KS ÌëúÏ§Ä HÌòïÍ∞ï ÏπòÏàò Îç∞Ïù¥ÌÑ∞ (Roll H) - ÏÇ¨Ïö© Í∑úÍ≤©Îßå =====
        const ksHBeamData = {
            // H x B : [B, tw, tf, r]
            400: { B: 200, tw: 8, tf: 13, r: 16 },     // H400x200
            450: { B: 200, tw: 9, tf: 14, r: 18 },     // H450x200 (Í∏∞Î≥∏Í∞í)
            500: { B: 200, tw: 10, tf: 16, r: 20 },    // H500x200
            506: { B: 201, tw: 11, tf: 19, r: 20 },    // H506x201
            600: { B: 200, tw: 11, tf: 17, r: 22 },    // H600x200
            606: { B: 201, tw: 12, tf: 20, r: 22 },    // H606x201
            582: { B: 300, tw: 12, tf: 17, r: 28 },    // H582x300
            588: { B: 300, tw: 12, tf: 20, r: 28 },    // H588x300
            692: { B: 300, tw: 13, tf: 20, r: 28 },    // H692x300
            700: { B: 300, tw: 13, tf: 24, r: 28 },    // H700x300
            800: { B: 300, tw: 14, tf: 26, r: 28 },    // H800x300
            900: { B: 300, tw: 16, tf: 28, r: 28 },    // H900x300
            912: { B: 302, tw: 18, tf: 34, r: 28 },    // H912x302
        };

        // Ï†ïÏ†Å Ïù¥ÎØ∏ÏßÄ ÏÇ¨Ïö©ÏúºÎ°ú Îã§Ïù¥Ïñ¥Í∑∏Îû® ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò ÎπÑÌôúÏÑ±Ìôî
        function updateCrossSection() {
            // Ï†ïÏ†Å Ïù¥ÎØ∏ÏßÄ (2H-section.png) ÏÇ¨Ïö©
        }

        // ÌòÑÏû¨ ÏÑ†ÌÉùÎêú ÌÉÄÏûÖ ÌôïÏù∏ (Rolled H or Pos-H)
        function isPosModeActive() {
            const activeBtn = document.querySelector('.type-btn.active');
            return activeBtn && activeBtn.dataset.type === 'posh';
        }

        // H1 ÏÑ†ÌÉù Ïãú ÏûêÎèôÏúºÎ°ú B1, tw1, tf1, r1 Ï±ÑÏö∞Í∏∞
        function updateH1Dimensions() {
            const h1Value = parseInt(document.getElementById('H1').value);
            if (ksHBeamData[h1Value]) {
                const data = ksHBeamData[h1Value];
                document.getElementById('B1').value = data.B;
                document.getElementById('tw1').value = data.tw;
                document.getElementById('tf1').value = data.tf;
                // Pos-H Î™®ÎìúÏóêÏÑúÎäî r1=0, K-COL Î™®ÎìúÏóêÏÑúÎäî KS ÌëúÏ§ÄÍ∞í
                document.getElementById('r1').value = isPosModeActive() ? 0 : data.r;
            }
            updateCrossSection();
        }

        // H2 ÏÑ†ÌÉù Ïãú ÏûêÎèôÏúºÎ°ú B2, tw2, tf2, r2 Ï±ÑÏö∞Í∏∞
        function updateH2Dimensions() {
            const h2Value = parseInt(document.getElementById('H2').value);
            if (ksHBeamData[h2Value]) {
                const data = ksHBeamData[h2Value];
                document.getElementById('B2').value = data.B;
                document.getElementById('tw2').value = data.tw;
                document.getElementById('tf2').value = data.tf;
                // Pos-H Î™®ÎìúÏóêÏÑúÎäî r2=0, K-COL Î™®ÎìúÏóêÏÑúÎäî KS ÌëúÏ§ÄÍ∞í
                document.getElementById('r2').value = isPosModeActive() ? 0 : data.r;
            }
            updateCrossSection();
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù
        document.getElementById('H1').addEventListener('change', updateH1Dimensions);
        document.getElementById('H2').addEventListener('change', updateH2Dimensions);

        // B, tw, tf ÏàòÎèô Î≥ÄÍ≤Ω ÏãúÏóêÎèÑ Îã§Ïù¥Ïñ¥Í∑∏Îû® ÏóÖÎç∞Ïù¥Ìä∏
        ['B1', 'tw1', 'tf1', 'B2', 'tw2', 'tf2'].forEach(id => {
            const el = document.getElementById(id);
            if (el) el.addEventListener('change', updateCrossSection);
        });

        // Cross H Îã®Î©¥Ï†Å Í≥ÑÏÇ∞ Î∞è ÌëúÏãú Ìï®Ïàò
        function calculateAndDisplaySectionArea() {
            const h1 = parseFloat(document.getElementById('H1').value) || 500;
            const b1 = parseFloat(document.getElementById('B1').value) || 200;
            const tw1 = parseFloat(document.getElementById('tw1').value) || 8;
            const tf1 = parseFloat(document.getElementById('tf1').value) || 13;
            const r1 = parseFloat(document.getElementById('r1').value) || 18;
            
            const h2 = parseFloat(document.getElementById('H2').value) || 450;
            const b2 = parseFloat(document.getElementById('B2').value) || 200;
            const tw2 = parseFloat(document.getElementById('tw2').value) || 9;
            const tf2 = parseFloat(document.getElementById('tf2').value) || 14;
            const r2 = parseFloat(document.getElementById('r2').value) || 18;

            // Cross H Îã®Î©¥Ï†Å Í≥ÑÏÇ∞
            const hw3 = h1 - 2 * tf1;
            const hw6 = h2 - 2 * tf2;
            const ag1 = b1 * tf1;
            const ag2 = b1 * tf1;
            const ag3 = hw3 * tw1;
            const ag4 = b2 * tf2;
            const ag5 = b2 * tf2;
            const ag6 = hw6 * tw2;
            const ag7 = 4 * (r1*r1 - Math.PI * r1*r1 / 4);
            const ag8 = 4 * (r2*r2 - Math.PI * r2*r2 / 4);
            const ag9 = tw1 * tw2;
            const area = ag1 + ag2 + ag3 + ag4 + ag5 + ag6 + ag7 + ag8 - ag9;

            // Îã®Ï§ë Í≥ÑÏÇ∞ (kg/m) = Îã®Î©¥Ï†Å(mm¬≤) √ó 7.85 / 1000
            const unitWeight = area * 7.85 / 1000;
            
            // Îã®Î©¥Ï†Å Î∞è Îã®Ï§ë ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏ (Í∞ôÏùÄ rowÏóê Î∞∞Ïπò)
            const areaDisplay = document.getElementById('section-area-display');
            if (areaDisplay) {
                areaDisplay.innerHTML = `Îã®Î©¥Ï†Å : ${area.toFixed(2)} mm¬≤  |  Îã®Ï§ë : ${unitWeight.toFixed(2)} kg/m`;
            }
        }

        // ÏûÖÎ†• ÌïÑÎìú Î≥ÄÍ≤Ω Ïãú Îã®Î©¥Ï†Å ÏûêÎèô Í≥ÑÏÇ∞
        ['H1', 'B1', 'tw1', 'tf1', 'r1', 'H2', 'B2', 'tw2', 'tf2', 'r2'].forEach(id => {
            const el = document.getElementById(id);
            if (el) {
                el.addEventListener('input', calculateAndDisplaySectionArea);
                el.addEventListener('change', calculateAndDisplaySectionArea);
            }
        });

        // steelGrade Î≥ÄÍ≤Ω Ïãú Fy ÏûêÎèô ÏóÖÎç∞Ïù¥Ìä∏
        document.getElementById('steelGrade').addEventListener('change', function() {
            const grade = this.value;
            let fyValue = 355; // Í∏∞Î≥∏Í∞í
            
            if (grade === 'SS275') {
                fyValue = 275;
            } else if (grade === 'SS355') {
                fyValue = 355;
            } else if (grade === 'SM355') {
                fyValue = 355;
            } else if (grade === 'SM420') {
                fyValue = 420;
            }
            
            document.getElementById('Fy').value = fyValue;
        });

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Í∞í ÏÑ§Ï†ï
        updateH1Dimensions();
        updateH2Dimensions();
        updateCrossSection();
        calculateAndDisplaySectionArea(); // Ï¥àÍ∏∞ Îã®Î©¥Ï†Å Í≥ÑÏÇ∞

        // Í∞ÑÌé∏ Í≥ÑÏÇ∞ Ìï®Ïàò - Based on 2H.py Python code
        function quickCalculate() {
            // ===== ÏûÖÎ†•Í∞í Í∞ÄÏ†∏Ïò§Í∏∞ =====
            const h1 = parseFloat(document.getElementById('H1').value) || 500;
            const b1 = parseFloat(document.getElementById('B1').value) || 200;
            const tw1 = parseFloat(document.getElementById('tw1').value) || 8;
            const tf1 = parseFloat(document.getElementById('tf1').value) || 13;
            const r1 = parseFloat(document.getElementById('r1').value) || 18;
            
            const h2 = parseFloat(document.getElementById('H2').value) || 450;
            const b2 = parseFloat(document.getElementById('B2').value) || 200;
            const tw2 = parseFloat(document.getElementById('tw2').value) || 9;
            const tf2 = parseFloat(document.getElementById('tf2').value) || 14;
            const r2 = parseFloat(document.getElementById('r2').value) || 18;
            
            const Fy = parseFloat(document.getElementById('Fy').value.replace(/,/g, '')) || 355;
            const E = parseFloat(document.getElementById('E').value.replace(/,/g, '')) || 210000;
            const nu = parseFloat(document.getElementById('nu').value) || 0.3;
            
            const Lx = parseFloat(document.getElementById('Lx').value) * 1000 || 4500; // m to mm
            const Ly = parseFloat(document.getElementById('Ly').value) * 1000 || 4500;
            const Kx = parseFloat(document.getElementById('Kx').value) || 0.8;
            const Ky = parseFloat(document.getElementById('Ky').value) || 0.8;
            const Kz = parseFloat(document.getElementById('Kz').value) || 0.8;
            
            const Pu = parseFloat(document.getElementById('Pu').value.replace(/,/g, '')) || 7561; // kN
            const Mux = parseFloat(document.getElementById('Mux').value) || 0; // kN.m
            const Muy = parseFloat(document.getElementById('Muy').value) || 0;
            const Vux = parseFloat(document.getElementById('Vux').value) || 0; // kN
            const Vuy = parseFloat(document.getElementById('Vuy').value) || 0;

            // ===== HBeam Class calculations =====
            const hw3 = h1 - 2 * tf1;
            const hw6 = h2 - 2 * tf2;
            const d1 = h1/2 - tf1/2;
            const d4 = h2/2 - tf2/2;

            // Total section area - Cross H section
            const ag1 = b1 * tf1;
            const ag2 = b1 * tf1;
            const ag3 = hw3 * tw1;
            const ag4 = b2 * tf2;
            const ag5 = b2 * tf2;
            const ag6 = hw6 * tw2;
            const ag7 = 4 * (r1*r1 - Math.PI * r1*r1 / 4);
            const ag8 = 4 * (r2*r2 - Math.PI * r2*r2 / 4);
            const ag9 = tw1 * tw2;
            const area = ag1 + ag2 + ag3 + ag4 + ag5 + ag6 + ag7 + ag8 - ag9;

            // Second inertia moment X-axis
            const Ix1 = 1/12 * b1 * Math.pow(tf1, 3) + ag1 * Math.pow(d1, 2);
            const Ix2 = 1/12 * b1 * Math.pow(tf1, 3) + ag1 * Math.pow(d1, 2);
            const Ix3 = 1/12 * tw1 * Math.pow(hw3, 3);
            const Ix4 = 1/12 * tf2 * Math.pow(b2, 3);
            const Ix5 = 1/12 * tf2 * Math.pow(b2, 3);
            const Ix6 = 1/12 * hw6 * Math.pow(tw2, 3);
            const Ix = Ix1 + Ix2 + Ix3 + Ix4 + Ix5 + Ix6;

            // Second inertia moment Y-axis
            const Iy4 = 1/12 * b2 * Math.pow(tf2, 3) + ag4 * Math.pow(d4, 2);
            const Iy5 = 1/12 * b2 * Math.pow(tf2, 3) + ag4 * Math.pow(d4, 2);
            const Iy6 = 1/12 * tw2 * Math.pow(hw6, 3);
            const Iy1 = 1/12 * tf1 * Math.pow(b1, 3);
            const Iy2 = 1/12 * tf1 * Math.pow(b1, 3);
            const Iy3 = 1/12 * hw3 * Math.pow(tw2, 3);
            const Iy = Iy1 + Iy2 + Iy3 + Iy4 + Iy5 + Iy6;

            // Radius of gyration
            const ix = Math.sqrt(Ix / area);
            const iy = Math.sqrt(Iy / area);

            // Elastic section modulus
            const sx = Ix / (h1 / 2);
            const sy = Iy / (h2 / 2);

            // Plastic section modulus Zx
            const Zx1 = (b1 * tf1) * d1;
            const Zx2 = (b1 * tf1) * d1;
            const Zx3 = (tw1 * hw3/2) * hw3/4;
            const Zx4 = (tw1 * hw3/2) * hw3/4;
            const Zx5 = (b2*b2 * tf2 / 2);
            const Zx6 = (tw2 * hw6 / 8) * 2;
            const zx = Zx1 + Zx2 + Zx3 + Zx4 + Zx5 + Zx6;

            // Plastic section modulus Zy
            const Zy1 = (b2 * tf2) * d4;
            const Zy2 = (b2 * tf2) * d4;
            const Zy3 = (tw2 * hw6/2) * hw6/4;
            const Zy4 = (tw2 * hw6/2) * hw6/4;
            const Zy5 = (b1*b1 * tf1 / 2);
            const Zy6 = (tw1 * hw3 / 8) * 2;
            const zy = Zy1 + Zy2 + Zy3 + Zy4 + Zy5 + Zy6;

            // Torsional constant J
            const J1 = (2*b1 * Math.pow(tf1, 3) + h1*Math.pow(tw1, 3)) / 3;
            const J2 = (2*b2 * Math.pow(tf2, 3) + h2*Math.pow(tw2, 3)) / 3;
            const J = J1 + J2;

            // Warping constant Cw
            const cw = Iy * Math.pow(h1 - tf1, 2) / 4;

            // ===== Column Class calculations =====
            // Slenderness ratio
            const lambdaX = Kx * Lx / ix;
            const lambdaY = Ky * Ly / iy;
            const lambda = Math.max(lambdaX, lambdaY);

            // Flexural Buckling Stress Fe1
            const Fe1 = Math.pow(Math.PI, 2) * E / Math.pow(lambda, 2);

            // Torsional Buckling Stress Fe2
            const G = E / (2 * (1 + nu));
            const Fe2 = (Math.pow(Math.PI, 2) * E * cw / Math.pow(Kz * Lx, 2) + G * J) / (Ix + Iy);

            // Critical stress Fcr
            const Fe = Math.min(Fe1, Fe2);
            const Fcr = Math.pow(0.658, Fy / Fe) * Fy;

            // Compressive Strength phi_Pn
            const phi_c = 0.9;
            const phi_Pn = phi_c * area * Fcr / 1000; // kN

            // Flexural Strength - Mpx, Mpy
            const Mpx = Math.min(Fy * zx, 1.6 * Fy * sx) / 1000000; // kN.m
            const Mpy = Math.min(Fy * zy, 1.6 * Fy * sy) / 1000000; // kN.m
            const phi_b = 0.9;
            const phi_Mnx = phi_b * Mpx;
            const phi_Mny = phi_b * Mpy;

            // Shear Strength
            const As1 = hw3 * tw1 + 2 * tf1 * b1;
            const As2 = hw6 * tw2 + 2 * tf2 * b2;
            const Cvw = 1.0;
            const phi_vw = 1.0;
            const Vny = 0.6 * Fy * As1 * Cvw / 1000; // kN
            const Vnx = 0.6 * Fy * As2 * Cvw / 1000; // kN
            const phi_Vny = phi_vw * Vny;
            const phi_Vnx = phi_vw * Vnx;

            // ===== ÎπÑÏú® Í≥ÑÏÇ∞ =====
            const ratio_comp = Pu / phi_Pn;
            const ratio_bendX = phi_Mnx > 0 ? Mux / phi_Mnx : 0;
            const ratio_bendY = phi_Mny > 0 ? Muy / phi_Mny : 0;
            const ratio_shearX = phi_Vnx > 0 ? Vux / phi_Vnx : 0;
            const ratio_shearY = phi_Vny > 0 ? Vuy / phi_Vny : 0;

            // P-M-M Ï°∞Ìï©
            let ratio_pmm;
            if (ratio_comp >= 0.2) {
                ratio_pmm = ratio_comp + (8/9) * (ratio_bendX + ratio_bendY);
            } else {
                ratio_pmm = ratio_comp / 2 + (ratio_bendX + ratio_bendY);
            }

            // ===== Í≤∞Í≥º ÏóÖÎç∞Ïù¥Ìä∏ =====
            // Îã®Î©¥Ï†Å ÌëúÏãú (Ïã§ÏãúÍ∞Ñ Í≥ÑÏÇ∞ Ìï®Ïàò Ìò∏Ï∂ú)
            calculateAndDisplaySectionArea();
            
            const results = document.querySelectorAll('.result-item');
            // Compressive: ratio > 1.0Ïù¥Î©¥ N.G (Í≥ÑÏÇ∞ÏÑúÏôÄ ÏùºÏπò)
            updateResult(results[0], ratio_comp, phi_Pn, 'compressive');
            // Bending X: ratio <= 1.0Ïù¥Î©¥ O.K (Í≥ÑÏÇ∞ÏÑúÏôÄ ÏùºÏπò)
            updateResult(results[1], ratio_bendX, phi_Mnx, 'bending');
            // Bending Y: ratio <= 1.0Ïù¥Î©¥ O.K (Í≥ÑÏÇ∞ÏÑúÏôÄ ÏùºÏπò)
            updateResult(results[2], ratio_bendY, phi_Mny, 'bending');
            // P-M-M: ratio > 1.0Ïù¥Î©¥ N.G (Í≥ÑÏÇ∞ÏÑúÏôÄ ÏùºÏπò)
            updateResult(results[3], ratio_pmm, null, 'pmm');
            // Shear X: ratio <= 1.0Ïù¥Î©¥ O.K (Í≥ÑÏÇ∞ÏÑúÏôÄ ÏùºÏπò)
            updateResult(results[4], ratio_shearX, phi_Vnx, 'shear');
            // Shear Y: ratio <= 1.0Ïù¥Î©¥ O.K (Í≥ÑÏÇ∞ÏÑúÏôÄ ÏùºÏπò)
            updateResult(results[5], ratio_shearY, phi_Vny, 'shear');

            // ÏΩòÏÜîÏóê ÏÉÅÏÑ∏ Í≤∞Í≥º Ï∂úÎ†•
            console.log('===== Cross H Column Calculation Results =====');
            console.log(`Area: ${area.toFixed(2)} mm¬≤`);
            console.log(`Ix: ${Ix.toFixed(2)} mm‚Å¥, Iy: ${Iy.toFixed(2)} mm‚Å¥`);
            console.log(`ix: ${ix.toFixed(2)} mm, iy: ${iy.toFixed(2)} mm`);
            console.log(`Œª (slenderness): ${lambda.toFixed(2)}`);
            console.log(`Fe1: ${Fe1.toFixed(2)} MPa, Fe2: ${Fe2.toFixed(2)} MPa`);
            console.log(`Fcr: ${Fcr.toFixed(2)} MPa`);
            console.log(`œÜPn: ${phi_Pn.toFixed(2)} kN`);
            console.log(`œÜMnx: ${phi_Mnx.toFixed(2)} kN.m, œÜMny: ${phi_Mny.toFixed(2)} kN.m`);
            console.log(`œÜVnx: ${phi_Vnx.toFixed(2)} kN, œÜVny: ${phi_Vny.toFixed(2)} kN`);
        }

        function updateResult(element, ratio, capacity, type) {
            const valSpan = element.querySelector('.result-val');
            const statusSpan = element.querySelector('.result-status');
            
            if (isNaN(ratio) || !isFinite(ratio)) {
                valSpan.textContent = '-';
                statusSpan.textContent = 'N/A';
                statusSpan.className = 'result-status pending';
                return;
            }
            
            valSpan.textContent = ratio.toFixed(3);
            
            // Í≥ÑÏÇ∞ÏÑúÏôÄ ÏùºÏπòÌïòÎäî Î°úÏßÅ Ï†ÅÏö©
            // Î™®Îì† Ìï≠Î™©Ïù¥ ratio <= 1.0Ïù¥Î©¥ O.K (Í≥ÑÏÇ∞ÏÑú Î°úÏßÅÍ≥º ÎèôÏùº)
            // Compressive, P-M-M, Bending, Shear Î™®Îëê ÎèôÏùºÌïú Í∏∞Ï§Ä ÏÇ¨Ïö©
            if (ratio <= 1.0) {
                statusSpan.textContent = 'O.K';
                statusSpan.className = 'result-status ok';
            } else {
                statusSpan.textContent = 'N.G';
                statusSpan.className = 'result-status ng';
            }
        }
        // Multi Column Calculation Sheet Ï¥àÍ∏∞Ìôî (6Í∞ú Í∏∞Îë•)
        function initializeMultiColumnTable() {
            const tbody = document.getElementById('multiColumnTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = ''; // Í∏∞Ï°¥ ÎÇ¥Ïö© Ï†úÍ±∞
            
            for (let i = 1; i <= 6; i++) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="column-number">${i}</td>
                    <td><input type="text" class="multi-input" data-col="pu" data-row="${i}" value="4000" placeholder="0"></td>
                    <td><input type="text" class="multi-input" data-col="mux" data-row="${i}" placeholder="0"></td>
                    <td><input type="text" class="multi-input" data-col="muy" data-row="${i}" placeholder="0"></td>
                    <td class="result-cell" data-result="compressive" data-row="${i}">-</td>
                    <td class="result-cell" data-result="pmm" data-row="${i}">-</td>
                `;
                tbody.appendChild(row);
            }
        }
        
        // Îã®Ïùº Í∏∞Îë• Í≥ÑÏÇ∞ Ìï®Ïàò (Pu, Mux, MuyÎ•º ÌååÎùºÎØ∏ÌÑ∞Î°ú Î∞õÏùå)
        function calculateSingleColumn(Pu, Mux, Muy) {
            // ===== ÏûÖÎ†•Í∞í Í∞ÄÏ†∏Ïò§Í∏∞ =====
            const h1 = parseFloat(document.getElementById('H1').value) || 500;
            const b1 = parseFloat(document.getElementById('B1').value) || 200;
            const tw1 = parseFloat(document.getElementById('tw1').value) || 8;
            const tf1 = parseFloat(document.getElementById('tf1').value) || 13;
            const r1 = parseFloat(document.getElementById('r1').value) || 18;
            
            const h2 = parseFloat(document.getElementById('H2').value) || 450;
            const b2 = parseFloat(document.getElementById('B2').value) || 200;
            const tw2 = parseFloat(document.getElementById('tw2').value) || 9;
            const tf2 = parseFloat(document.getElementById('tf2').value) || 14;
            const r2 = parseFloat(document.getElementById('r2').value) || 18;
            
            const Fy = parseFloat(document.getElementById('Fy').value.replace(/,/g, '')) || 355;
            const E = parseFloat(document.getElementById('E').value.replace(/,/g, '')) || 210000;
            const nu = parseFloat(document.getElementById('nu').value) || 0.3;
            
            const Lx = parseFloat(document.getElementById('Lx').value) * 1000 || 4500; // m to mm
            const Ly = parseFloat(document.getElementById('Ly').value) * 1000 || 4500;
            const Kx = parseFloat(document.getElementById('Kx').value) || 0.8;
            const Ky = parseFloat(document.getElementById('Ky').value) || 0.8;
            const Kz = parseFloat(document.getElementById('Kz').value) || 0.8;

            // ===== HBeam Class calculations =====
            const hw3 = h1 - 2 * tf1;
            const hw6 = h2 - 2 * tf2;
            const d1 = h1/2 - tf1/2;
            const d4 = h2/2 - tf2/2;

            // Total section area - Cross H section
            const ag1 = b1 * tf1;
            const ag2 = b1 * tf1;
            const ag3 = hw3 * tw1;
            const ag4 = b2 * tf2;
            const ag5 = b2 * tf2;
            const ag6 = hw6 * tw2;
            const ag7 = 4 * (r1*r1 - Math.PI * r1*r1 / 4);
            const ag8 = 4 * (r2*r2 - Math.PI * r2*r2 / 4);
            const ag9 = tw1 * tw2;
            const area = ag1 + ag2 + ag3 + ag4 + ag5 + ag6 + ag7 + ag8 - ag9;

            // Second inertia moment X-axis
            const Ix1 = 1/12 * b1 * Math.pow(tf1, 3) + ag1 * Math.pow(d1, 2);
            const Ix2 = 1/12 * b1 * Math.pow(tf1, 3) + ag1 * Math.pow(d1, 2);
            const Ix3 = 1/12 * tw1 * Math.pow(hw3, 3);
            const Ix4 = 1/12 * tf2 * Math.pow(b2, 3);
            const Ix5 = 1/12 * tf2 * Math.pow(b2, 3);
            const Ix6 = 1/12 * hw6 * Math.pow(tw2, 3);
            const Ix = Ix1 + Ix2 + Ix3 + Ix4 + Ix5 + Ix6;

            // Second inertia moment Y-axis
            const Iy4 = 1/12 * b2 * Math.pow(tf2, 3) + ag4 * Math.pow(d4, 2);
            const Iy5 = 1/12 * b2 * Math.pow(tf2, 3) + ag4 * Math.pow(d4, 2);
            const Iy6 = 1/12 * tw2 * Math.pow(hw6, 3);
            const Iy1 = 1/12 * tf1 * Math.pow(b1, 3);
            const Iy2 = 1/12 * tf1 * Math.pow(b1, 3);
            const Iy3 = 1/12 * hw3 * Math.pow(tw2, 3);
            const Iy = Iy1 + Iy2 + Iy3 + Iy4 + Iy5 + Iy6;

            // Radius of gyration
            const ix = Math.sqrt(Ix / area);
            const iy = Math.sqrt(Iy / area);

            // Elastic section modulus
            const sx = Ix / (h1 / 2);
            const sy = Iy / (h2 / 2);

            // Plastic section modulus Zx
            const Zx1 = (b1 * tf1) * d1;
            const Zx2 = (b1 * tf1) * d1;
            const Zx3 = (tw1 * hw3/2) * hw3/4;
            const Zx4 = (tw1 * hw3/2) * hw3/4;
            const Zx5 = (b2*b2 * tf2 / 2);
            const Zx6 = (tw2 * hw6 / 8) * 2;
            const zx = Zx1 + Zx2 + Zx3 + Zx4 + Zx5 + Zx6;

            // Plastic section modulus Zy
            const Zy1 = (b2 * tf2) * d4;
            const Zy2 = (b2 * tf2) * d4;
            const Zy3 = (tw2 * hw6/2) * hw6/4;
            const Zy4 = (tw2 * hw6/2) * hw6/4;
            const Zy5 = (b1*b1 * tf1 / 2);
            const Zy6 = (tw1 * hw3 / 8) * 2;
            const zy = Zy1 + Zy2 + Zy3 + Zy4 + Zy5 + Zy6;

            // Torsional constant J
            const J1 = (2*b1 * Math.pow(tf1, 3) + h1*Math.pow(tw1, 3)) / 3;
            const J2 = (2*b2 * Math.pow(tf2, 3) + h2*Math.pow(tw2, 3)) / 3;
            const J = J1 + J2;

            // Warping constant Cw
            const cw = Iy * Math.pow(h1 - tf1, 2) / 4;

            // ===== Column Class calculations =====
            // Slenderness ratio
            const lambdaX = Kx * Lx / ix;
            const lambdaY = Ky * Ly / iy;
            const lambda = Math.max(lambdaX, lambdaY);

            // Flexural Buckling Stress Fe1
            const Fe1 = Math.pow(Math.PI, 2) * E / Math.pow(lambda, 2);

            // Torsional Buckling Stress Fe2
            const G = E / (2 * (1 + nu));
            const Fe2 = (Math.pow(Math.PI, 2) * E * cw / Math.pow(Kz * Lx, 2) + G * J) / (Ix + Iy);

            // Critical stress Fcr
            const Fe = Math.min(Fe1, Fe2);
            const Fcr = Math.pow(0.658, Fy / Fe) * Fy;

            // Compressive Strength phi_Pn
            const phi_c = 0.9;
            const phi_Pn = phi_c * area * Fcr / 1000; // kN

            // Flexural Strength - Mpx, Mpy
            const Mpx = Math.min(Fy * zx, 1.6 * Fy * sx) / 1000000; // kN.m
            const Mpy = Math.min(Fy * zy, 1.6 * Fy * sy) / 1000000; // kN.m
            const phi_b = 0.9;
            const phi_Mnx = phi_b * Mpx;
            const phi_Mny = phi_b * Mpy;

            // ===== ÎπÑÏú® Í≥ÑÏÇ∞ =====
            const ratio_comp = Pu / phi_Pn;
            const ratio_bendX = phi_Mnx > 0 ? Mux / phi_Mnx : 0;
            const ratio_bendY = phi_Mny > 0 ? Muy / phi_Mny : 0;

            // P-M-M Ï°∞Ìï©
            let ratio_pmm;
            if (ratio_comp >= 0.2) {
                ratio_pmm = ratio_comp + (8/9) * (ratio_bendX + ratio_bendY);
            } else {
                ratio_pmm = ratio_comp / 2 + (ratio_bendX + ratio_bendY);
            }

            return {
                compressive: ratio_comp,
                pmm: ratio_pmm
            };
        }

        // Multi Column Execution Ìï®Ïàò
        function executeMultiColumnCalculation() {
            const rows = document.querySelectorAll('#multiColumnTableBody tr');
            
            rows.forEach((row, index) => {
                const rowNum = index + 1;
                
                // Í∞Å ÌñâÏóêÏÑú Pu, Mux, Muy Í∞í ÏùΩÍ∏∞
                const puInput = row.querySelector('input[data-col="pu"]');
                const muxInput = row.querySelector('input[data-col="mux"]');
                const muyInput = row.querySelector('input[data-col="muy"]');
                
                const Pu = parseFloat(puInput.value) || 0;
                const Mux = parseFloat(muxInput.value) || 0;
                const Muy = parseFloat(muyInput.value) || 0;
                
                // Í≥ÑÏÇ∞ ÏàòÌñâ
                const results = calculateSingleColumn(Pu, Mux, Muy);
                
                // Í≤∞Í≥º Ï∂úÎ†•
                const compressiveCell = row.querySelector('[data-result="compressive"]');
                const pmmCell = row.querySelector('[data-result="pmm"]');
                
                if (compressiveCell) {
                    compressiveCell.textContent = results.compressive.toFixed(3);
                }
                if (pmmCell) {
                    pmmCell.textContent = results.pmm.toFixed(3);
                }
            });
            
            console.log('Multi Column Execution ÏôÑÎ£å');
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÌÖåÏù¥Î∏î Ï¥àÍ∏∞Ìôî
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeMultiColumnTable);
        } else {
            initializeMultiColumnTable();
            addLoginModal();
            
            // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            document.addEventListener('click', function(e) {
                const modal = document.getElementById('loginModal');
                if (modal && e.target === modal) {
                    closeLoginModal();
                }
            });
        }

        // Î°úÍ∑∏Ïù∏ Î™®Îã¨ HTML Ï∂îÍ∞Ä
        function addLoginModal() {
            // Ïù¥ÎØ∏ Î™®Îã¨Ïù¥ ÏûàÏúºÎ©¥ Ï∂îÍ∞ÄÌïòÏßÄ ÏïäÏùå
            if (document.getElementById('loginModal')) {
                return;
            }

            const modalHTML = `
                <div id="loginModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
                    <div style="background: white; border-radius: 12px; padding: 30px; max-width: 400px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                        <h2 style="margin-bottom: 20px; color: #1e3a5f; font-size: 24px; text-align: center;">Î°úÍ∑∏Ïù∏</h2>
                        <p style="margin-bottom: 20px; color: #718096; font-size: 14px; text-align: center;">PDF Î≥¥Í∏∞Î•º ÏúÑÌï¥ Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.</p>
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; color: #4a5568; font-weight: 600; font-size: 14px;">ID (ÏÇ¨ÏóÖÏûêÎ≤àÌò∏)</label>
                            <input type="text" id="loginUserId" placeholder="ÏÇ¨ÏóÖÏûêÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" 
                                   style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 14px;"
                                   onkeypress="if(event.key==='Enter') handleLogin()">
                        </div>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 5px; color: #4a5568; font-weight: 600; font-size: 14px;">ÎπÑÎ∞ÄÎ≤àÌò∏</label>
                            <input type="password" id="loginPassword" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" 
                                   style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 14px;"
                                   onkeypress="if(event.key==='Enter') handleLogin()">
                        </div>
                        <div id="loginError" style="color: #e53e3e; font-size: 13px; margin-bottom: 15px; min-height: 20px; text-align: center;"></div>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="handleLogin()" 
                                    style="flex: 1; padding: 12px; background: #667eea; color: white; border: none; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer;">
                                Î°úÍ∑∏Ïù∏
                            </button>
                            <button onclick="closeLoginModal()" 
                                    style="flex: 1; padding: 12px; background: #cbd5e0; color: #4a5568; border: none; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer;">
                                Ï∑®ÏÜå
                            </button>
                        </div>
                        <div style="margin-top: 15px; text-align: center; font-size: 12px; color: #718096;">
                            <a href="#" style="color: #667eea; text-decoration: none;">ÌöåÏõêÍ∞ÄÏûÖ</a> | 
                            <a href="#" style="color: #667eea; text-decoration: none;">ÎπÑÎ∞ÄÎ≤àÌò∏ Ï∞æÍ∏∞</a>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
    </script>
</body>
</html>
